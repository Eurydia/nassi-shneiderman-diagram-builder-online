{"version":3,"file":"index-TpXrAFFK.js","sources":["../../src/interpreter/lexer.ts","../../src/interpreter/parser.ts","../../src/components/StructogramNodeWrapper.tsx","../../src/components/ArrowTopLeftBottomRight.tsx","../../src/components/ArrowBottomLeftTopRight.tsx","../../src/components/StructogramNode.tsx","../../src/renderer/renderer.tsx","../../src/components/StructogramCodeEditor/StructogramCodeEditor.tsx","../../src/components/AdaptiveButton.tsx","../../src/routes/EditorPage.tsx","../../src/App.tsx","../../src/main.tsx"],"sourcesContent":["export enum TokenKind {\r\n\tEND = 0,\r\n\tSYMBOL,\r\n\tKEYWORD,\r\n\r\n\tLEFT_PAREN,\r\n\tRIGHT_PAREN,\r\n\tLEFT_CURLY,\r\n\tRIGHT_CURLY,\r\n\tSEMICOLON,\r\n\tWHITE_SPACE,\r\n}\r\n\r\nexport type Token = {\r\n\tkind: TokenKind;\r\n\ttext: string;\r\n};\r\n\r\nconst KEYWORDS: string[] = [\r\n\t\"for\",\r\n\t\"if\",\r\n\t\"else\",\r\n\t\"while\",\r\n\t\"do\",\r\n];\r\n\r\nconst LITERAL_TOKENS: Record<string, TokenKind> =\r\n\t{\r\n\t\t\"{\": TokenKind.LEFT_CURLY,\r\n\t\t\"}\": TokenKind.RIGHT_CURLY,\r\n\t\t\"(\": TokenKind.LEFT_PAREN,\r\n\t\t\")\": TokenKind.RIGHT_PAREN,\r\n\t\t\";\": TokenKind.SEMICOLON,\r\n\t};\r\n\r\nexport type Lexer = {\r\n\tcontent: string;\r\n\tcontentLength: number;\r\n\tcursorPos: number;\r\n};\r\n\r\nexport const lexerInit = (\r\n\tcontent: string,\r\n): Lexer => {\r\n\treturn {\r\n\t\tcontent: content.normalize(),\r\n\t\tcontentLength: content.normalize().length,\r\n\t\tcursorPos: 0,\r\n\t};\r\n};\r\n\r\nexport const lexerSafeGetNextTokenThenAdvance = (\r\n\tl: Lexer,\r\n): Token => {\r\n\tconst token = {\r\n\t\tkind: TokenKind.END,\r\n\t\ttext: \"\",\r\n\t};\r\n\r\n\tif (l.cursorPos >= l.contentLength) {\r\n\t\treturn token;\r\n\t}\r\n\r\n\tif (/\\s/.test(l.content[l.cursorPos])) {\r\n\t\ttoken[\"kind\"] = TokenKind.WHITE_SPACE;\r\n\t\ttoken[\"text\"] = l.content[l.cursorPos];\r\n\t\tl.cursorPos++;\r\n\t\treturn token;\r\n\t}\r\n\r\n\ttoken[\"text\"] = l.content[l.cursorPos];\r\n\tl.cursorPos++;\r\n\r\n\tif (token[\"text\"] in LITERAL_TOKENS) {\r\n\t\ttoken[\"kind\"] = LITERAL_TOKENS[token[\"text\"]];\r\n\t\treturn token;\r\n\t}\r\n\r\n\twhile (\r\n\t\tl.cursorPos < l.contentLength &&\r\n\t\t!(l.content[l.cursorPos] in LITERAL_TOKENS) &&\r\n\t\t!/\\s/.test(l.content[l.cursorPos])\r\n\t) {\r\n\t\ttoken[\"text\"] += l.content[l.cursorPos];\r\n\t\tl.cursorPos++;\r\n\t}\r\n\r\n\tif (KEYWORDS.includes(token[\"text\"])) {\r\n\t\ttoken[\"kind\"] = TokenKind.KEYWORD;\r\n\t\treturn token;\r\n\t}\r\n\r\n\ttoken[\"kind\"] = TokenKind.SYMBOL;\r\n\treturn token;\r\n};\r\n\r\nexport const lexerGetAllTokens = (\r\n\tl: Lexer,\r\n): Token[] => {\r\n\tconst tokens: Token[] = [];\r\n\tlet token: Token;\r\n\twhile (\r\n\t\t(token = lexerSafeGetNextTokenThenAdvance(l))\r\n\t\t\t.kind !== TokenKind.END\r\n\t) {\r\n\t\ttokens.push(token);\r\n\t}\r\n\treturn tokens;\r\n};\r\n","import { Token, TokenKind } from \"./lexer\";\r\n\r\nexport enum NodeKind {\r\n\tEND,\r\n\tPROCESS,\r\n\tLOOP_FIRST,\r\n\tLOOP_LAST,\r\n\tIF_ELSE,\r\n}\r\n\r\nexport type NodeEnd = {\r\n\tkind: NodeKind.END;\r\n};\r\n\r\nexport type NodeProcess = {\r\n\tkind: NodeKind.PROCESS;\r\n\tbody: Token[];\r\n};\r\n\r\nexport type NodeLoopFirst = {\r\n\tkind: NodeKind.LOOP_FIRST;\r\n\tcondition: Token[];\r\n\tbody: Node[];\r\n};\r\n\r\nexport type NodeLoopLast = {\r\n\tkind: NodeKind.LOOP_LAST;\r\n\tcondition: Token[];\r\n\tbody: Node[];\r\n};\r\n\r\nexport type NodeIfElse = {\r\n\tkind: NodeKind.IF_ELSE;\r\n\tcondition: Token[];\r\n\tbodyIf: Node[];\r\n\tbodyElse: Node[];\r\n};\r\n\r\nexport type Node =\r\n\t| NodeEnd\r\n\t| NodeProcess\r\n\t| NodeLoopFirst\r\n\t| NodeLoopLast\r\n\t| NodeIfElse;\r\n\r\nexport type Parser = {\r\n\ttokens: Token[];\r\n\ttokenLength: number;\r\n\tcursorPos: number;\r\n};\r\n\r\nexport const parserInit = (\r\n\ttokens: Token[],\r\n): Parser => {\r\n\treturn {\r\n\t\ttokens: tokens,\r\n\t\ttokenLength: tokens.length,\r\n\t\tcursorPos: 0,\r\n\t};\r\n};\r\n\r\nconst parserCollectTokens = (\r\n\tp: Parser,\r\n\tstartToken: TokenKind,\r\n\tstopToken: TokenKind,\r\n): Token[] => {\r\n\tif (p.cursorPos >= p.tokenLength) {\r\n\t\treturn [];\r\n\t}\r\n\tif (p.tokens[p.cursorPos].kind !== startToken) {\r\n\t\treturn [];\r\n\t}\r\n\tp.cursorPos++;\r\n\tconst tokens: Token[] = [];\r\n\tlet depth = -1;\r\n\tlet token: Token;\r\n\twhile (p.cursorPos < p.tokenLength) {\r\n\t\ttoken = p.tokens[p.cursorPos];\r\n\t\tp.cursorPos++;\r\n\t\tif (token.kind === startToken) {\r\n\t\t\tdepth--;\r\n\t\t}\r\n\t\tif (token.kind === stopToken) {\r\n\t\t\tdepth++;\r\n\t\t}\r\n\t\tif (depth === 0) {\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\ttokens.push(token);\r\n\t}\r\n\treturn tokens;\r\n};\r\n\r\nconst parserSkipWhiteSpace = (\r\n\tp: Parser,\r\n): void => {\r\n\twhile (\r\n\t\tp.cursorPos < p.tokenLength &&\r\n\t\tp.tokens[p.cursorPos].kind ===\r\n\t\t\tTokenKind.WHITE_SPACE\r\n\t) {\r\n\t\tp.cursorPos++;\r\n\t}\r\n};\r\n\r\nconst parserBuildLoopFirstNode = (\r\n\tp: Parser,\r\n): NodeLoopFirst => {\r\n\tconst node: NodeLoopFirst = {\r\n\t\tkind: NodeKind.LOOP_FIRST,\r\n\t\tbody: [],\r\n\t\tcondition: [],\r\n\t};\r\n\r\n\tparserSkipWhiteSpace(p);\r\n\tif (p.cursorPos >= p.tokenLength) {\r\n\t\treturn node;\r\n\t}\r\n\tif (\r\n\t\tp.tokens[p.cursorPos].kind !==\r\n\t\tTokenKind.LEFT_PAREN\r\n\t) {\r\n\t\treturn node;\r\n\t}\r\n\r\n\tnode.condition = parserCollectTokens(\r\n\t\tp,\r\n\t\tTokenKind.LEFT_PAREN,\r\n\t\tTokenKind.RIGHT_PAREN,\r\n\t);\r\n\r\n\tparserSkipWhiteSpace(p);\r\n\tif (p.cursorPos >= p.tokenLength) {\r\n\t\treturn node;\r\n\t}\r\n\tif (\r\n\t\tp.tokens[p.cursorPos].kind !==\r\n\t\tTokenKind.LEFT_CURLY\r\n\t) {\r\n\t\treturn node;\r\n\t}\r\n\r\n\tnode.body = parserGetAllNodes(\r\n\t\tparserInit(\r\n\t\t\tparserCollectTokens(\r\n\t\t\t\tp,\r\n\t\t\t\tTokenKind.LEFT_CURLY,\r\n\t\t\t\tTokenKind.RIGHT_CURLY,\r\n\t\t\t),\r\n\t\t),\r\n\t);\r\n\r\n\treturn node;\r\n};\r\n\r\nconst parserBuildLoopLastNode = (\r\n\tp: Parser,\r\n): NodeLoopLast => {\r\n\tconst node: NodeLoopLast = {\r\n\t\tkind: NodeKind.LOOP_LAST,\r\n\t\tbody: [],\r\n\t\tcondition: [],\r\n\t};\r\n\r\n\tparserSkipWhiteSpace(p);\r\n\tif (p.cursorPos >= p.tokenLength) {\r\n\t\treturn node;\r\n\t}\r\n\tif (\r\n\t\tp.tokens[p.cursorPos].kind !==\r\n\t\tTokenKind.LEFT_CURLY\r\n\t) {\r\n\t\treturn node;\r\n\t}\r\n\tnode.body = parserGetAllNodes(\r\n\t\tparserInit(\r\n\t\t\tparserCollectTokens(\r\n\t\t\t\tp,\r\n\t\t\t\tTokenKind.LEFT_CURLY,\r\n\t\t\t\tTokenKind.RIGHT_CURLY,\r\n\t\t\t),\r\n\t\t),\r\n\t);\r\n\r\n\tparserSkipWhiteSpace(p);\r\n\tif (p.cursorPos >= p.tokenLength) {\r\n\t\treturn node;\r\n\t}\r\n\tif (\r\n\t\tp.tokens[p.cursorPos].kind !==\r\n\t\t\tTokenKind.KEYWORD ||\r\n\t\tp.tokens[p.cursorPos].text !== \"while\"\r\n\t) {\r\n\t\treturn node;\r\n\t}\r\n\tp.cursorPos++; // consume the \"while\" keyword\r\n\r\n\tparserSkipWhiteSpace(p);\r\n\tif (p.cursorPos >= p.tokenLength) {\r\n\t\treturn node;\r\n\t}\r\n\tif (\r\n\t\tp.tokens[p.cursorPos].kind !==\r\n\t\tTokenKind.LEFT_PAREN\r\n\t) {\r\n\t\treturn node;\r\n\t}\r\n\tnode.condition = parserCollectTokens(\r\n\t\tp,\r\n\t\tTokenKind.LEFT_PAREN,\r\n\t\tTokenKind.RIGHT_PAREN,\r\n\t);\r\n\r\n\tparserSkipWhiteSpace(p);\r\n\tif (p.cursorPos >= p.tokenLength) {\r\n\t\treturn node;\r\n\t}\r\n\tif (\r\n\t\tp.tokens[p.cursorPos].kind ===\r\n\t\tTokenKind.SEMICOLON\r\n\t) {\r\n\t\tp.cursorPos++; // consume the semicolon\r\n\t}\r\n\r\n\treturn node;\r\n};\r\n\r\nconst parserBuildIfElseNode = (\r\n\tp: Parser,\r\n): NodeIfElse => {\r\n\tconst node: NodeIfElse = {\r\n\t\tkind: NodeKind.IF_ELSE,\r\n\t\tcondition: [],\r\n\t\tbodyIf: [],\r\n\t\tbodyElse: [],\r\n\t};\r\n\r\n\tparserSkipWhiteSpace(p);\r\n\tif (p.cursorPos >= p.tokenLength) {\r\n\t\treturn node;\r\n\t}\r\n\tif (\r\n\t\tp.tokens[p.cursorPos].kind !==\r\n\t\tTokenKind.LEFT_PAREN\r\n\t) {\r\n\t\treturn node;\r\n\t}\r\n\tnode.condition = parserCollectTokens(\r\n\t\tp,\r\n\t\tTokenKind.LEFT_PAREN,\r\n\t\tTokenKind.RIGHT_PAREN,\r\n\t);\r\n\r\n\tparserSkipWhiteSpace(p);\r\n\tif (p.cursorPos >= p.tokenLength) {\r\n\t\treturn node;\r\n\t}\r\n\tif (\r\n\t\tp.tokens[p.cursorPos].kind !==\r\n\t\tTokenKind.LEFT_CURLY\r\n\t) {\r\n\t\treturn node;\r\n\t}\r\n\tnode.bodyIf = parserGetAllNodes(\r\n\t\tparserInit(\r\n\t\t\tparserCollectTokens(\r\n\t\t\t\tp,\r\n\t\t\t\tTokenKind.LEFT_CURLY,\r\n\t\t\t\tTokenKind.RIGHT_CURLY,\r\n\t\t\t),\r\n\t\t),\r\n\t);\r\n\r\n\tparserSkipWhiteSpace(p);\r\n\tif (p.cursorPos >= p.tokenLength) {\r\n\t\treturn node;\r\n\t}\r\n\tif (\r\n\t\tp.tokens[p.cursorPos].kind !==\r\n\t\t\tTokenKind.KEYWORD ||\r\n\t\tp.tokens[p.cursorPos].text !== \"else\"\r\n\t) {\r\n\t\treturn node;\r\n\t}\r\n\tp.cursorPos++; // consume the \"else\" keyword\r\n\r\n\tparserSkipWhiteSpace(p);\r\n\tif (p.cursorPos >= p.tokenLength) {\r\n\t\treturn node;\r\n\t}\r\n\tif (\r\n\t\tp.tokens[p.cursorPos].kind !==\r\n\t\tTokenKind.LEFT_CURLY\r\n\t) {\r\n\t\treturn node;\r\n\t}\r\n\tnode.bodyElse = parserGetAllNodes(\r\n\t\tparserInit(\r\n\t\t\tparserCollectTokens(\r\n\t\t\t\tp,\r\n\t\t\t\tTokenKind.LEFT_CURLY,\r\n\t\t\t\tTokenKind.RIGHT_CURLY,\r\n\t\t\t),\r\n\t\t),\r\n\t);\r\n\treturn node;\r\n};\r\n\r\nexport const parserGetNextNodeThenAdvance = (\r\n\tp: Parser,\r\n): Node => {\r\n\tparserSkipWhiteSpace(p);\r\n\r\n\tif (p.cursorPos >= p.tokenLength) {\r\n\t\treturn {\r\n\t\t\tkind: NodeKind.END,\r\n\t\t};\r\n\t}\r\n\r\n\tlet token = p.tokens[p.cursorPos];\r\n\tp.cursorPos++;\r\n\tif (token.kind === TokenKind.KEYWORD) {\r\n\t\tswitch (token.text) {\r\n\t\t\tcase \"for\":\r\n\t\t\tcase \"while\":\r\n\t\t\t\treturn parserBuildLoopFirstNode(p);\r\n\t\t\tcase \"do\":\r\n\t\t\t\treturn parserBuildLoopLastNode(p);\r\n\t\t\tcase \"if\":\r\n\t\t\t\treturn parserBuildIfElseNode(p);\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tconst node: NodeProcess = {\r\n\t\tkind: NodeKind.PROCESS,\r\n\t\tbody: [],\r\n\t};\r\n\r\n\tif (token.kind === TokenKind.SEMICOLON) {\r\n\t\treturn node;\r\n\t}\r\n\r\n\tnode.body.push(token);\r\n\r\n\twhile (p.cursorPos < p.tokenLength) {\r\n\t\ttoken = p.tokens[p.cursorPos];\r\n\t\tp.cursorPos++;\r\n\t\tif (\r\n\t\t\ttoken.kind === TokenKind.END ||\r\n\t\t\ttoken.kind === TokenKind.SEMICOLON\r\n\t\t) {\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tnode.body.push(token);\r\n\t}\r\n\r\n\treturn node;\r\n};\r\n\r\nexport const parserGetAllNodes = (\r\n\tp: Parser,\r\n): Node[] => {\r\n\tconst nodes: Node[] = [];\r\n\tlet node: Node;\r\n\twhile (\r\n\t\t(node = parserGetNextNodeThenAdvance(p))\r\n\t\t\t.kind !== NodeKind.END\r\n\t) {\r\n\t\tnodes.push(node);\r\n\t}\r\n\r\n\treturn nodes;\r\n};\r\n","import { FC, ReactNode } from \"react\";\r\nimport { Box } from \"@mui/material\";\r\n\r\ntype StructogramNodeWrapperProps = {\r\n\tchildren: ReactNode | ReactNode[];\r\n\tborderTop?: boolean;\r\n\tborderBottom?: boolean;\r\n\tborderRight?: boolean;\r\n\tborderLeft?: boolean;\r\n};\r\nexport const StructogramNodeWrapper: FC<\r\n\tStructogramNodeWrapperProps\r\n> = (props) => {\r\n\tconst {\r\n\t\tchildren,\r\n\t\tborderTop,\r\n\t\tborderBottom,\r\n\t\tborderLeft,\r\n\t\tborderRight,\r\n\t} = props;\r\n\treturn (\r\n\t\t<Box\r\n\t\t\theight=\"100%\"\r\n\t\t\tsx={{\r\n\t\t\t\tborderColor: \"inherit\",\r\n\t\t\t\tbackgroundColor: \"inherit\",\r\n\t\t\t\tborderStyle: \"solid\",\r\n\t\t\t\tborderLeftWidth: borderLeft\r\n\t\t\t\t\t? \"inherit\"\r\n\t\t\t\t\t: 0,\r\n\t\t\t\tborderTopWidth: borderTop ? \"inherit\" : 0,\r\n\t\t\t\tborderBottomWidth: borderBottom\r\n\t\t\t\t\t? \"inherit\"\r\n\t\t\t\t\t: 0,\r\n\t\t\t\tborderRightWidth: borderRight\r\n\t\t\t\t\t? \"inherit\"\r\n\t\t\t\t\t: 0,\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t{children}\r\n\t\t</Box>\r\n\t);\r\n};\r\n","import { FC } from \"react\";\r\nimport {\r\n\tSvgIconProps,\r\n\tSvgIcon,\r\n} from \"@mui/material\";\r\n\r\nexport const ArrowTopLeftBottomRight: FC<\r\n\tSvgIconProps\r\n> = (props) => {\r\n\tconst { sx } = props;\r\n\r\n\treturn (\r\n\t\t<SvgIcon\r\n\t\t\tsx={{\r\n\t\t\t\tposition: \"absolute\",\r\n\t\t\t\twidth: \"100%\",\r\n\t\t\t\theight: \"100%\",\r\n\t\t\t\t...sx,\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<svg\r\n\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\tpreserveAspectRatio=\"none\"\r\n\t\t\t\tfill=\"none\"\r\n\t\t\t\tviewBox=\"0 0 5 5\"\r\n\t\t\t\tstrokeWidth=\"0.1\"\r\n\t\t\t>\r\n\t\t\t\t<line\r\n\t\t\t\t\tx1=\"0\"\r\n\t\t\t\t\ty1=\"0\"\r\n\t\t\t\t\tx2=\"5\"\r\n\t\t\t\t\ty2=\"5\"\r\n\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\tstrokeLinecap=\"round\"\r\n\t\t\t\t/>\r\n\t\t\t</svg>\r\n\t\t</SvgIcon>\r\n\t);\r\n};\r\n","import { FC } from \"react\";\r\nimport {\r\n\tSvgIconProps,\r\n\tSvgIcon,\r\n} from \"@mui/material\";\r\n\r\nexport const ArrowBottomLeftTopRight: FC<\r\n\tSvgIconProps\r\n> = (props) => {\r\n\tconst { sx } = props;\r\n\r\n\treturn (\r\n\t\t<SvgIcon\r\n\t\t\tsx={{\r\n\t\t\t\tposition: \"absolute\",\r\n\t\t\t\twidth: \"100%\",\r\n\t\t\t\theight: \"100%\",\r\n\t\t\t\t...sx,\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<svg\r\n\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\tpreserveAspectRatio=\"none\"\r\n\t\t\t\tfill=\"none\"\r\n\t\t\t\tviewBox=\"0 0 5 5\"\r\n\t\t\t\tstrokeWidth=\"0.1\"\r\n\t\t\t>\r\n\t\t\t\t<line\r\n\t\t\t\t\tx1=\"0\"\r\n\t\t\t\t\ty1=\"5\"\r\n\t\t\t\t\tx2=\"5\"\r\n\t\t\t\t\ty2=\"0\"\r\n\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\tstrokeLinecap=\"round\"\r\n\t\t\t\t/>\r\n\t\t\t</svg>\r\n\t\t</SvgIcon>\r\n\t);\r\n};\r\n","import { FC, Fragment, ReactNode } from \"react\";\r\nimport {\r\n\tBox,\r\n\tGrid,\r\n\tTypographyProps,\r\n\tTypography,\r\n} from \"@mui/material\";\r\nimport { grey } from \"@mui/material/colors\";\r\n\r\nimport { StructogramNodeWrapper } from \"./StructogramNodeWrapper\";\r\nimport { ArrowTopLeftBottomRight } from \"./ArrowTopLeftBottomRight\";\r\nimport { ArrowBottomLeftTopRight } from \"./ArrowBottomLeftTopRight\";\r\nimport { Node, NodeKind } from \"interpreter\";\r\n\r\ntype StructogramComponentTextProps =\r\n\tTypographyProps & {\r\n\t\tchildren?: string;\r\n\t};\r\nconst StructogramComponentText: FC<\r\n\tStructogramComponentTextProps\r\n> = (props) => {\r\n\tconst { children, ...rest } = props;\r\n\r\n\treturn (\r\n\t\t<Typography\r\n\t\t\tfontFamily=\"inherit\"\r\n\t\t\tfontWeight=\"inherit\"\r\n\t\t\tpadding={1}\r\n\t\t\tpaddingLeft={2}\r\n\t\t\t{...rest}\r\n\t\t>\r\n\t\t\t{children ?? \"...\"}\r\n\t\t</Typography>\r\n\t);\r\n};\r\n\r\ntype StructogramNodeProcessProps = {\r\n\ttext?: string;\r\n\tborderTop?: boolean;\r\n\tborderBottom?: boolean;\r\n\tborderRight?: boolean;\r\n\tborderLeft?: boolean;\r\n};\r\nexport const StructogramNodeProcess: FC<\r\n\tStructogramNodeProcessProps\r\n> = (props) => {\r\n\tconst { text, ...rest } = props;\r\n\r\n\treturn (\r\n\t\t<StructogramNodeWrapper {...rest}>\r\n\t\t\t<StructogramComponentText>\r\n\t\t\t\t{text}\r\n\t\t\t</StructogramComponentText>\r\n\t\t</StructogramNodeWrapper>\r\n\t);\r\n};\r\n\r\ntype StructogramNodeLoopFirstProps = {\r\n\tcondition?: string;\r\n\tbody: Node[];\r\n\tborderTop?: boolean;\r\n\tborderBottom?: boolean;\r\n\tborderRight?: boolean;\r\n\tborderLeft?: boolean;\r\n};\r\nexport const StructogramNodeLoopFirst: FC<\r\n\tStructogramNodeLoopFirstProps\r\n> = (props) => {\r\n\tconst { condition, body, ...rest } = props;\r\n\r\n\tlet bodyNode: ReactNode | ReactNode[] = (\r\n\t\t<StructogramNodeProcess\r\n\t\t\tborderTop\r\n\t\t\tborderLeft\r\n\t\t/>\r\n\t);\r\n\r\n\tif (body.length > 0) {\r\n\t\tbodyNode = body.map((subnode, index) => (\r\n\t\t\t<StructogramNode\r\n\t\t\t\tkey={`subnode-${index}`}\r\n\t\t\t\tborderTop\r\n\t\t\t\tborderLeft\r\n\t\t\t\tnode={subnode}\r\n\t\t\t/>\r\n\t\t));\r\n\t}\r\n\r\n\treturn (\r\n\t\t<StructogramNodeWrapper {...rest}>\r\n\t\t\t<StructogramComponentText>\r\n\t\t\t\t{condition}\r\n\t\t\t</StructogramComponentText>\r\n\t\t\t<Box paddingLeft={2}>{bodyNode}</Box>\r\n\t\t</StructogramNodeWrapper>\r\n\t);\r\n};\r\n\r\ntype StructogramNodeLoopLastProps = {\r\n\tcondition?: string;\r\n\tbody: Node[];\r\n\tborderTop?: boolean;\r\n\tborderBottom?: boolean;\r\n\tborderRight?: boolean;\r\n\tborderLeft?: boolean;\r\n};\r\nexport const StructogramNodeLoopLast: FC<\r\n\tStructogramNodeLoopLastProps\r\n> = (props) => {\r\n\tconst { condition, body, ...rest } = props;\r\n\r\n\tlet bodyNode: ReactNode | ReactNode[] = (\r\n\t\t<StructogramNodeProcess\r\n\t\t\tborderBottom\r\n\t\t\tborderLeft\r\n\t\t/>\r\n\t);\r\n\tif (body.length > 0) {\r\n\t\tbodyNode = body.map((subnode, index) => (\r\n\t\t\t<StructogramNode\r\n\t\t\t\tkey={`subnode-${index}`}\r\n\t\t\t\tnode={subnode}\r\n\t\t\t\tborderBottom\r\n\t\t\t\tborderLeft\r\n\t\t\t/>\r\n\t\t));\r\n\t}\r\n\treturn (\r\n\t\t<StructogramNodeWrapper {...rest}>\r\n\t\t\t<Box paddingLeft={2}>{bodyNode}</Box>\r\n\t\t\t<StructogramComponentText>\r\n\t\t\t\t{condition}\r\n\t\t\t</StructogramComponentText>\r\n\t\t</StructogramNodeWrapper>\r\n\t);\r\n};\r\n\r\ntype StructogramNodeIfElseProps = {\r\n\tcondition?: string;\r\n\tbodyIf: Node[];\r\n\tbodyElse: Node[];\r\n\tborderTop?: boolean;\r\n\tborderBottom?: boolean;\r\n\tborderRight?: boolean;\r\n\tborderLeft?: boolean;\r\n};\r\nexport const StructogramNodeIfElse: FC<\r\n\tStructogramNodeIfElseProps\r\n> = (props) => {\r\n\tconst { condition, bodyIf, bodyElse, ...rest } =\r\n\t\tprops;\r\n\r\n\tlet bodyNodeIf: ReactNode | ReactNode[] = (\r\n\t\t<StructogramNodeProcess\r\n\t\t\tborderTop\r\n\t\t\tborderRight\r\n\t\t/>\r\n\t);\r\n\tif (bodyIf.length > 0) {\r\n\t\tbodyNodeIf = bodyIf.map((subnode, index) => (\r\n\t\t\t<StructogramNode\r\n\t\t\t\tkey={`index-${index}`}\r\n\t\t\t\tborderTop\r\n\t\t\t\tborderRight\r\n\t\t\t\tnode={subnode}\r\n\t\t\t/>\r\n\t\t));\r\n\t}\r\n\r\n\tlet bodyNodeElse: ReactNode | ReactNode[] = (\r\n\t\t<StructogramNodeProcess borderTop />\r\n\t);\r\n\tif (bodyElse.length > 0) {\r\n\t\tbodyNodeElse = bodyElse.map(\r\n\t\t\t(subnode, index) => (\r\n\t\t\t\t<StructogramNode\r\n\t\t\t\t\tkey={`index-${index}`}\r\n\t\t\t\t\tborderTop\r\n\t\t\t\t\tnode={subnode}\r\n\t\t\t\t/>\r\n\t\t\t),\r\n\t\t);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<StructogramNodeWrapper {...rest}>\r\n\t\t\t<Grid\r\n\t\t\t\tcontainer\r\n\t\t\t\theight=\"100%\"\r\n\t\t\t>\r\n\t\t\t\t<Grid\r\n\t\t\t\t\titem\r\n\t\t\t\t\txs={12}\r\n\t\t\t\t>\r\n\t\t\t\t\t<StructogramComponentText>\r\n\t\t\t\t\t\t{condition}\r\n\t\t\t\t\t</StructogramComponentText>\r\n\t\t\t\t</Grid>\r\n\t\t\t\t<Grid\r\n\t\t\t\t\titem\r\n\t\t\t\t\txs={6}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Box\r\n\t\t\t\t\t\theight=\"100%\"\r\n\t\t\t\t\t\tdisplay=\"flex\"\r\n\t\t\t\t\t\talignItems=\"center\"\r\n\t\t\t\t\t\tjustifyContent=\"center\"\r\n\t\t\t\t\t\tposition=\"relative\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<ArrowTopLeftBottomRight color=\"inherit\" />\r\n\t\t\t\t\t\t<StructogramComponentText\r\n\t\t\t\t\t\t\tsx={{\r\n\t\t\t\t\t\t\t\tzIndex: 2,\r\n\t\t\t\t\t\t\t\tbackgroundColor: grey[300],\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tTrue\r\n\t\t\t\t\t\t</StructogramComponentText>\r\n\t\t\t\t\t</Box>\r\n\t\t\t\t</Grid>\r\n\t\t\t\t<Grid\r\n\t\t\t\t\titem\r\n\t\t\t\t\txs={6}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Box\r\n\t\t\t\t\t\theight=\"100%\"\r\n\t\t\t\t\t\tdisplay=\"flex\"\r\n\t\t\t\t\t\talignItems=\"center\"\r\n\t\t\t\t\t\tjustifyContent=\"center\"\r\n\t\t\t\t\t\tposition=\"relative\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<ArrowBottomLeftTopRight color=\"inherit\" />\r\n\t\t\t\t\t\t<StructogramComponentText\r\n\t\t\t\t\t\t\tsx={{\r\n\t\t\t\t\t\t\t\tzIndex: 2,\r\n\t\t\t\t\t\t\t\tbackgroundColor: grey[300],\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tFalse\r\n\t\t\t\t\t\t</StructogramComponentText>\r\n\t\t\t\t\t</Box>\r\n\t\t\t\t</Grid>\r\n\t\t\t\t<Grid\r\n\t\t\t\t\titem\r\n\t\t\t\t\txs={6}\r\n\t\t\t\t>\r\n\t\t\t\t\t{bodyNodeIf}\r\n\t\t\t\t</Grid>\r\n\t\t\t\t<Grid\r\n\t\t\t\t\titem\r\n\t\t\t\t\txs={6}\r\n\t\t\t\t>\r\n\t\t\t\t\t{bodyNodeElse}\r\n\t\t\t\t</Grid>\r\n\t\t\t</Grid>\r\n\t\t</StructogramNodeWrapper>\r\n\t);\r\n};\r\n\r\nconst fitlerEmptyNode = (node: Node): boolean => {\r\n\treturn (\r\n\t\tnode.kind !== NodeKind.PROCESS ||\r\n\t\tnode.body\r\n\t\t\t.map((token) => token.text)\r\n\t\t\t.join(\"\")\r\n\t\t\t.trim().length > 0\r\n\t);\r\n};\r\n\r\ntype StructogramNodeProps = {\r\n\tnode: Node;\r\n\tborderTop?: boolean;\r\n\tborderBottom?: boolean;\r\n\tborderRight?: boolean;\r\n\tborderLeft?: boolean;\r\n};\r\nexport const StructogramNode: FC<\r\n\tStructogramNodeProps\r\n> = (props) => {\r\n\tconst { node, ...rest } = props;\r\n\r\n\tswitch (node.kind) {\r\n\t\tcase NodeKind.LOOP_FIRST: {\r\n\t\t\tlet text: string | undefined;\r\n\t\t\tif (node.condition.length > 0) {\r\n\t\t\t\ttext = node.condition\r\n\t\t\t\t\t.map((token) => token.text)\r\n\t\t\t\t\t.join(\"\")\r\n\t\t\t\t\t.trim();\r\n\t\t\t}\r\n\t\t\treturn (\r\n\t\t\t\t<StructogramNodeLoopFirst\r\n\t\t\t\t\t{...rest}\r\n\t\t\t\t\tcondition={text}\r\n\t\t\t\t\tbody={node.body.filter(fitlerEmptyNode)}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\t\tcase NodeKind.LOOP_LAST: {\r\n\t\t\tlet text: string | undefined;\r\n\t\t\tif (node.condition.length > 0) {\r\n\t\t\t\ttext = node.condition\r\n\t\t\t\t\t.map((token) => token.text)\r\n\t\t\t\t\t.join(\"\")\r\n\t\t\t\t\t.trim();\r\n\t\t\t}\r\n\t\t\treturn (\r\n\t\t\t\t<StructogramNodeLoopLast\r\n\t\t\t\t\t{...rest}\r\n\t\t\t\t\tcondition={text}\r\n\t\t\t\t\tbody={node.body.filter(fitlerEmptyNode)}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\t\tcase NodeKind.IF_ELSE: {\r\n\t\t\tlet text: string | undefined;\r\n\t\t\tif (node.condition.length > 0) {\r\n\t\t\t\ttext = node.condition\r\n\t\t\t\t\t.map((token) => token.text)\r\n\t\t\t\t\t.join(\"\")\r\n\t\t\t\t\t.trim();\r\n\t\t\t}\r\n\t\t\treturn (\r\n\t\t\t\t<StructogramNodeIfElse\r\n\t\t\t\t\t{...rest}\r\n\t\t\t\t\tcondition={text}\r\n\t\t\t\t\tbodyIf={node.bodyIf.filter(\r\n\t\t\t\t\t\tfitlerEmptyNode,\r\n\t\t\t\t\t)}\r\n\t\t\t\t\tbodyElse={node.bodyElse.filter(\r\n\t\t\t\t\t\tfitlerEmptyNode,\r\n\t\t\t\t\t)}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\t\tcase NodeKind.PROCESS: {\r\n\t\t\tlet text: string | undefined = node.body\r\n\t\t\t\t.map((token) => token.text)\r\n\t\t\t\t.join(\"\")\r\n\t\t\t\t.trim();\r\n\r\n\t\t\tif (text.length === 0) {\r\n\t\t\t\ttext = undefined;\r\n\t\t\t}\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<StructogramNodeProcess\r\n\t\t\t\t\t{...rest}\r\n\t\t\t\t\ttext={text}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\treturn <Fragment />;\r\n};\r\n","import { ReactNode } from \"react\";\r\nimport {\r\n\tBox,\r\n\tSxProps,\r\n\tTypography,\r\n} from \"@mui/material\";\r\n\r\nimport { Node, NodeKind } from \"interpreter\";\r\nimport { StructogramNode } from \"components/StructogramNode\";\r\n\r\nexport const renderer = (\r\n\tnodes: Node[],\r\n\tid: string,\r\n\tboxProps: SxProps,\r\n) => {\r\n\tlet component: ReactNode | ReactNode[] = (\r\n\t\t<Typography\r\n\t\t\tfontFamily=\"inherit\"\r\n\t\t\tfontStyle=\"italic\"\r\n\t\t>\r\n\t\t\tNothing to display.\r\n\t\t</Typography>\r\n\t);\r\n\r\n\tconst filteredNodes = nodes.filter(\r\n\t\t(node) =>\r\n\t\t\tnode.kind !== NodeKind.PROCESS ||\r\n\t\t\tnode.body\r\n\t\t\t\t.map((token) => token.text)\r\n\t\t\t\t.join(\"\")\r\n\t\t\t\t.trim().length > 0,\r\n\t);\r\n\r\n\tif (filteredNodes.length > 0) {\r\n\t\tcomponent = filteredNodes.map(\r\n\t\t\t(node, index) => (\r\n\t\t\t\t<StructogramNode\r\n\t\t\t\t\tkey={index}\r\n\t\t\t\t\tnode={node}\r\n\t\t\t\t\tborderLeft\r\n\t\t\t\t\tborderTop\r\n\t\t\t\t\tborderRight\r\n\t\t\t\t\tborderBottom={\r\n\t\t\t\t\t\tindex === filteredNodes.length - 1\r\n\t\t\t\t\t}\r\n\t\t\t\t/>\r\n\t\t\t),\r\n\t\t);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Box sx={boxProps}>\r\n\t\t\t<Box\r\n\t\t\t\tid={id}\r\n\t\t\t\tmaxWidth=\"640px\"\r\n\t\t\t\tfontFamily=\"Fira Code\"\r\n\t\t\t\tsx={{\r\n\t\t\t\t\twordBreak: \"break-all\",\r\n\t\t\t\t\tfontVariantLigatures: \"contextual\",\r\n\t\t\t\t\tuserSelect: \"none\",\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t{component}\r\n\t\t\t</Box>\r\n\t\t</Box>\r\n\t);\r\n};\r\n","import { FC } from \"react\";\r\nimport { Box, SxProps } from \"@mui/material\";\r\n\r\nimport ReactCodeMirror from \"@uiw/react-codemirror\";\r\n\r\nimport \"./styles.css\";\r\n\r\ntype StructogramCodeEditorProps = {\r\n\tvalue: string;\r\n\tonValueChange?: (value: string) => void;\r\n\tboxProps?: SxProps;\r\n};\r\nexport const StructogramCodeEditor: FC<\r\n\tStructogramCodeEditorProps\r\n> = (props) => {\r\n\tconst { value, onValueChange, boxProps } =\r\n\t\tprops;\r\n\r\n\treturn (\r\n\t\t<Box sx={boxProps}>\r\n\t\t\t<ReactCodeMirror\r\n\t\t\t\tvalue={value}\r\n\t\t\t\tonChange={onValueChange}\r\n\t\t\t\ttheme=\"dark\"\r\n\t\t\t/>\r\n\t\t</Box>\r\n\t);\r\n};\r\n","import { FC } from \"react\";\r\nimport {\r\n\tButton,\r\n\tButtonProps,\r\n\tTooltip,\r\n} from \"@mui/material\";\r\n\r\ntype AdaptiveButtonProps = ButtonProps & {\r\n\tcollapse: boolean;\r\n};\r\nexport const AdaptiveButton: FC<\r\n\tAdaptiveButtonProps\r\n> = (props) => {\r\n\tconst { collapse, ...rest } = props;\r\n\r\n\tif (collapse) {\r\n\t\treturn (\r\n\t\t\t<Tooltip title={rest.children}>\r\n\t\t\t\t<Button\r\n\t\t\t\t\t{...rest}\r\n\t\t\t\t\tstartIcon={undefined}\r\n\t\t\t\t\tendIcon={undefined}\r\n\t\t\t\t>\r\n\t\t\t\t\t{rest.startIcon}\r\n\t\t\t\t\t{rest.endIcon}\r\n\t\t\t\t</Button>\r\n\t\t\t</Tooltip>\r\n\t\t);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Button\r\n\t\t\t{...rest}\r\n\t\t\tstartIcon={rest.startIcon}\r\n\t\t\tendIcon={rest.endIcon}\r\n\t\t>\r\n\t\t\t{rest.children}\r\n\t\t</Button>\r\n\t);\r\n};\r\n","import {\r\n\tFC,\r\n\tFragment,\r\n\tuseCallback,\r\n\tuseEffect,\r\n\tuseState,\r\n} from \"react\";\r\nimport {\r\n\tBox,\r\n\tGrid,\r\n\tStack,\r\n\tPaper,\r\n\tButton,\r\n\tMenuList,\r\n\tListItemText,\r\n\tButtonGroup,\r\n\tPopover,\r\n\tMenuItem,\r\n\tListItemIcon,\r\n\tuseMediaQuery,\r\n\tTheme,\r\n} from \"@mui/material\";\r\nimport {\r\n\tDownloadRounded,\r\n\tLaunchRounded,\r\n\tSendRounded,\r\n} from \"@mui/icons-material\";\r\nimport { grey } from \"@mui/material/colors\";\r\nimport { useSnackbar } from \"notistack\";\r\nimport {\r\n\ttoJpeg,\r\n\ttoPng,\r\n\ttoSvg,\r\n} from \"html-to-image\";\r\nimport { saveAs } from \"file-saver\";\r\n\r\nimport {\r\n\tlexerGetAllTokens,\r\n\tlexerInit,\r\n\tNode,\r\n\tparserGetAllNodes,\r\n\tparserInit,\r\n} from \"interpreter\";\r\nimport { renderer } from \"renderer\";\r\n\r\nimport { StructogramCodeEditor } from \"components/StructogramCodeEditor\";\r\nimport { AdaptiveButton } from \"components/AdaptiveButton\";\r\n\r\nexport const EditorPage: FC = () => {\r\n\tconst { enqueueSnackbar } = useSnackbar();\r\n\tconst matchBreakpointXs = useMediaQuery<Theme>(\r\n\t\t(theme) => theme.breakpoints.down(\"md\"),\r\n\t);\r\n\r\n\tconst [\r\n\t\tpopoverExportMenuAnchor,\r\n\t\tsetPopoverExportMenuAnchor,\r\n\t] = useState<HTMLButtonElement | null>(null);\r\n\r\n\tconst [previewOpen, setPreviewOpen] = useState(\r\n\t\t() => {\r\n\t\t\tconst url = new URL(window.location.href);\r\n\t\t\tconst preview =\r\n\t\t\t\turl.searchParams.get(\"preview\");\r\n\t\t\tif (preview === null) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\treturn preview === \"true\";\r\n\t\t},\r\n\t);\r\n\tconst [nodes, setNodes] = useState<Node[]>([]);\r\n\tconst [editorContent, setEditorContent] =\r\n\t\tuseState(() => {\r\n\t\t\tconst url = new URL(window.location.href);\r\n\t\t\tconst content =\r\n\t\t\t\turl.searchParams.get(\"content\");\r\n\t\t\tif (content !== null) {\r\n\t\t\t\twindow.localStorage.setItem(\r\n\t\t\t\t\t\"content\",\r\n\t\t\t\t\tcontent,\r\n\t\t\t\t);\r\n\t\t\t\treturn content;\r\n\t\t\t}\r\n\r\n\t\t\tconst savedContent =\r\n\t\t\t\twindow.localStorage.getItem(\"content\");\r\n\t\t\tif (savedContent !== null) {\r\n\t\t\t\treturn savedContent;\r\n\t\t\t}\r\n\t\t\treturn \"\";\r\n\t\t});\r\n\r\n\tuseEffect(() => {\r\n\t\tconst tokens = lexerGetAllTokens(\r\n\t\t\tlexerInit(editorContent),\r\n\t\t);\r\n\r\n\t\tconst nodes = parserGetAllNodes(\r\n\t\t\tparserInit(tokens),\r\n\t\t);\r\n\r\n\t\tsetNodes(nodes);\r\n\t}, [editorContent]);\r\n\r\n\tconst onContentChange = useCallback(\r\n\t\t(v: string) => {\r\n\t\t\tsetEditorContent(v);\r\n\t\t\twindow.localStorage.setItem(\"content\", v);\r\n\t\t},\r\n\t\t[],\r\n\t);\r\n\tconst handleSaveSVG = useCallback(async () => {\r\n\t\tconst HTMLNode = document.getElementById(\r\n\t\t\t\"structogram-preview-region\",\r\n\t\t);\r\n\t\tif (HTMLNode === null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\ttoSvg(HTMLNode).then((blob) => {\r\n\t\t\tif (blob === null) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (window.saveAs) {\r\n\t\t\t\twindow.saveAs(blob, \"structogram\");\r\n\t\t\t} else {\r\n\t\t\t\tsaveAs(blob, \"structogram\");\r\n\t\t\t}\r\n\t\t});\r\n\t\tenqueueSnackbar(\"Saved structogram as SVG\", {\r\n\t\t\tvariant: \"info\",\r\n\t\t});\r\n\t}, [enqueueSnackbar]);\r\n\r\n\tconst handleSavePNG = useCallback(async () => {\r\n\t\tconst HTMLNode = document.getElementById(\r\n\t\t\t\"structogram-preview-region\",\r\n\t\t);\r\n\t\tif (HTMLNode === null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\ttoPng(HTMLNode).then((blob) => {\r\n\t\t\tif (blob === null) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (window.saveAs) {\r\n\t\t\t\twindow.saveAs(blob, \"structogram\");\r\n\t\t\t} else {\r\n\t\t\t\tsaveAs(blob, \"structogram\");\r\n\t\t\t}\r\n\t\t});\r\n\t\tenqueueSnackbar(\"Saved structogram as PNG\", {\r\n\t\t\tvariant: \"info\",\r\n\t\t});\r\n\t}, [enqueueSnackbar]);\r\n\r\n\tconst handleSaveJPEG = useCallback(async () => {\r\n\t\tconst HTMLNode = document.getElementById(\r\n\t\t\t\"structogram-preview-region\",\r\n\t\t);\r\n\t\tif (HTMLNode === null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\ttoJpeg(HTMLNode).then((blob) => {\r\n\t\t\tif (blob === null) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (window.saveAs) {\r\n\t\t\t\twindow.saveAs(blob, \"structogram\");\r\n\t\t\t} else {\r\n\t\t\t\tsaveAs(blob, \"structogram\");\r\n\t\t\t}\r\n\t\t});\r\n\t\tenqueueSnackbar(\"Saved structogram as JPEG\", {\r\n\t\t\tvariant: \"info\",\r\n\t\t});\r\n\t}, [enqueueSnackbar]);\r\n\r\n\tconst handlePreviewToggle = useCallback(() => {\r\n\t\tsetPreviewOpen((prev) => !prev);\r\n\t}, []);\r\n\r\n\tconst handleCopyLink = useCallback(() => {\r\n\t\tconst url = new URL(window.location.href);\r\n\t\turl.searchParams.set(\"preview\", \"true\");\r\n\t\turl.searchParams.set(\r\n\t\t\t\"content\",\r\n\t\t\teditorContent,\r\n\t\t);\r\n\t\tnavigator.clipboard.writeText(url.href);\r\n\t\tenqueueSnackbar(\"Copied link to clipboard\", {\r\n\t\t\tvariant: \"info\",\r\n\t\t});\r\n\t}, [editorContent, enqueueSnackbar]);\r\n\r\n\tconst handlePopoverExportMenuOpen = useCallback(\r\n\t\t(\r\n\t\t\tevent: React.MouseEvent<HTMLButtonElement>,\r\n\t\t) => {\r\n\t\t\tsetPopoverExportMenuAnchor(\r\n\t\t\t\tevent.currentTarget,\r\n\t\t\t);\r\n\t\t},\r\n\t\t[],\r\n\t);\r\n\tconst handlePopoverExportMenuClose =\r\n\t\tuseCallback(() => {\r\n\t\t\tsetPopoverExportMenuAnchor(null);\r\n\t\t}, []);\r\n\r\n\treturn (\r\n\t\t<Fragment>\r\n\t\t\t<Box>\r\n\t\t\t\t<Paper\r\n\t\t\t\t\tsquare\r\n\t\t\t\t\televation={0}\r\n\t\t\t\t\tsx={{\r\n\t\t\t\t\t\tpadding: 1,\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Stack\r\n\t\t\t\t\t\tdisplay=\"flex\"\r\n\t\t\t\t\t\tdirection=\"row\"\r\n\t\t\t\t\t\tjustifyContent=\"space-between\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<ButtonGroup variant=\"outlined\">\r\n\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\tonClick={handlePreviewToggle}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{previewOpen\r\n\t\t\t\t\t\t\t\t\t? \"Show code\"\r\n\t\t\t\t\t\t\t\t\t: \"Hide code\"}\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\thref=\"https://eurydia.github.io/project-nassi-shneiderman-diagram-builder-online-docs/\"\r\n\t\t\t\t\t\t\t\tcomponent=\"a\"\r\n\t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\t\t\t\t\tendIcon={<LaunchRounded />}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tdocs\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t</ButtonGroup>\r\n\t\t\t\t\t\t<ButtonGroup variant=\"outlined\">\r\n\t\t\t\t\t\t\t<AdaptiveButton\r\n\t\t\t\t\t\t\t\tcollapse={matchBreakpointXs}\r\n\t\t\t\t\t\t\t\tstartIcon={<DownloadRounded />}\r\n\t\t\t\t\t\t\t\tonClick={\r\n\t\t\t\t\t\t\t\t\thandlePopoverExportMenuOpen\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tEXPORT\r\n\t\t\t\t\t\t\t</AdaptiveButton>\r\n\t\t\t\t\t\t\t<AdaptiveButton\r\n\t\t\t\t\t\t\t\tcollapse={matchBreakpointXs}\r\n\t\t\t\t\t\t\t\tendIcon={<SendRounded />}\r\n\t\t\t\t\t\t\t\tonClick={handleCopyLink}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tSHARE\r\n\t\t\t\t\t\t\t</AdaptiveButton>\r\n\t\t\t\t\t\t</ButtonGroup>\r\n\t\t\t\t\t</Stack>\r\n\t\t\t\t</Paper>\r\n\t\t\t\t<Box>\r\n\t\t\t\t\t<Grid container>\r\n\t\t\t\t\t\t<Grid\r\n\t\t\t\t\t\t\titem\r\n\t\t\t\t\t\t\txs={12}\r\n\t\t\t\t\t\t\tlg={6}\r\n\t\t\t\t\t\t\tdisplay={\r\n\t\t\t\t\t\t\t\tpreviewOpen ? \"none\" : undefined\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<StructogramCodeEditor\r\n\t\t\t\t\t\t\t\tvalue={editorContent}\r\n\t\t\t\t\t\t\t\tonValueChange={onContentChange}\r\n\t\t\t\t\t\t\t\tboxProps={{\r\n\t\t\t\t\t\t\t\t\toverflowY: \"auto\",\r\n\t\t\t\t\t\t\t\t\theight:\r\n\t\t\t\t\t\t\t\t\t\t\"calc(100vh - 61.6833px)\",\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t\t<Grid\r\n\t\t\t\t\t\t\titem\r\n\t\t\t\t\t\t\txs\r\n\t\t\t\t\t\t\tlg\r\n\t\t\t\t\t\t\tdisplay={\r\n\t\t\t\t\t\t\t\tmatchBreakpointXs && !previewOpen\r\n\t\t\t\t\t\t\t\t\t? \"none\"\r\n\t\t\t\t\t\t\t\t\t: undefined\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{renderer(\r\n\t\t\t\t\t\t\t\tnodes,\r\n\t\t\t\t\t\t\t\t\"structogram-preview-region\",\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tpadding: 4,\r\n\t\t\t\t\t\t\t\t\toverflowY: \"auto\",\r\n\t\t\t\t\t\t\t\t\tbackgroundColor: grey[300],\r\n\t\t\t\t\t\t\t\t\theight:\r\n\t\t\t\t\t\t\t\t\t\t\"calc(100vh - 61.6833px)\",\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t</Box>\r\n\t\t\t</Box>\r\n\t\t\t<Popover\r\n\t\t\t\tanchorOrigin={{\r\n\t\t\t\t\tvertical: \"bottom\",\r\n\t\t\t\t\thorizontal: \"left\",\r\n\t\t\t\t}}\r\n\t\t\t\ttransformOrigin={{\r\n\t\t\t\t\tvertical: \"top\",\r\n\t\t\t\t\thorizontal: \"left\",\r\n\t\t\t\t}}\r\n\t\t\t\tanchorEl={popoverExportMenuAnchor}\r\n\t\t\t\topen={popoverExportMenuAnchor !== null}\r\n\t\t\t\tonClose={handlePopoverExportMenuClose}\r\n\t\t\t>\r\n\t\t\t\t<Paper\r\n\t\t\t\t\tsx={{\r\n\t\t\t\t\t\tpadding: 1,\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<MenuList>\r\n\t\t\t\t\t\t<MenuItem onClick={handleSaveJPEG}>\r\n\t\t\t\t\t\t\t<ListItemIcon>\r\n\t\t\t\t\t\t\t\t<DownloadRounded fontSize=\"small\" />\r\n\t\t\t\t\t\t\t</ListItemIcon>\r\n\t\t\t\t\t\t\t<ListItemText>\r\n\t\t\t\t\t\t\t\tSave as JPEG\r\n\t\t\t\t\t\t\t</ListItemText>\r\n\t\t\t\t\t\t</MenuItem>\r\n\t\t\t\t\t\t<MenuItem onClick={handleSavePNG}>\r\n\t\t\t\t\t\t\t<ListItemIcon>\r\n\t\t\t\t\t\t\t\t<DownloadRounded fontSize=\"small\" />\r\n\t\t\t\t\t\t\t</ListItemIcon>\r\n\t\t\t\t\t\t\t<ListItemText>\r\n\t\t\t\t\t\t\t\tSave as PNG\r\n\t\t\t\t\t\t\t</ListItemText>\r\n\t\t\t\t\t\t</MenuItem>\r\n\t\t\t\t\t\t<MenuItem onClick={handleSaveSVG}>\r\n\t\t\t\t\t\t\t<ListItemIcon>\r\n\t\t\t\t\t\t\t\t<DownloadRounded fontSize=\"small\" />\r\n\t\t\t\t\t\t\t</ListItemIcon>\r\n\t\t\t\t\t\t\t<ListItemText>\r\n\t\t\t\t\t\t\t\tSave as SVG\r\n\t\t\t\t\t\t\t</ListItemText>\r\n\t\t\t\t\t\t</MenuItem>\r\n\t\t\t\t\t</MenuList>\r\n\t\t\t\t</Paper>\r\n\t\t\t</Popover>\r\n\t\t</Fragment>\r\n\t);\r\n};\r\n","import { Fragment, FC } from \"react\";\r\nimport {\r\n\tCssBaseline,\r\n\tThemeProvider,\r\n\tcreateTheme,\r\n} from \"@mui/material\";\r\n\r\nimport { SnackbarProvider } from \"notistack\";\r\n\r\nimport { EditorPage } from \"routes/EditorPage\";\r\n\r\nconst themeDark = createTheme({\r\n\tpalette: {\r\n\t\tmode: \"dark\",\r\n\t},\r\n});\r\n\r\nexport const App: FC = () => {\r\n\treturn (\r\n\t\t<Fragment>\r\n\t\t\t<CssBaseline />\r\n\t\t\t<ThemeProvider theme={themeDark}>\r\n\t\t\t\t<SnackbarProvider\r\n\t\t\t\t\tpreventDuplicate\r\n\t\t\t\t\tautoHideDuration={2000}\r\n\t\t\t\t\tanchorOrigin={{\r\n\t\t\t\t\t\tvertical: \"top\",\r\n\t\t\t\t\t\thorizontal: \"center\",\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<EditorPage />\r\n\t\t\t\t</SnackbarProvider>\r\n\t\t\t</ThemeProvider>\r\n\t\t</Fragment>\r\n\t);\r\n};\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom/client\";\r\n\r\nimport { App } from \"./App.tsx\";\r\n\r\nReactDOM.createRoot(\r\n\tdocument.getElementById(\"root\")!,\r\n).render(\r\n\t<React.StrictMode>\r\n\t\t<App />\r\n\t</React.StrictMode>,\r\n);\r\n"],"names":["TokenKind","TokenKind2","KEYWORDS","LITERAL_TOKENS","lexerSafeGetNextTokenThenAdvance","l","token","kind","text","cursorPos","contentLength","test","content","includes","NodeKind","NodeKind2","parserInit","tokens","tokenLength","length","parserCollectTokens","p","startToken","stopToken","depth","push","parserSkipWhiteSpace","WHITE_SPACE","parserGetNextNodeThenAdvance","KEYWORD","node","body","condition","LEFT_PAREN","RIGHT_PAREN","LEFT_CURLY","parserGetAllNodes","RIGHT_CURLY","parserBuildLoopFirstNode","SEMICOLON","parserBuildLoopLastNode","bodyIf","bodyElse","parserBuildIfElseNode","END","nodes","StructogramNodeWrapper","props","children","borderTop","borderBottom","borderLeft","borderRight","jsxRuntimeExports","jsx","Box","height","sx","borderColor","backgroundColor","borderStyle","borderLeftWidth","borderTopWidth","borderBottomWidth","borderRightWidth","ArrowTopLeftBottomRight","SvgIcon","position","width","xmlns","preserveAspectRatio","fill","viewBox","strokeWidth","x1","y1","x2","y2","stroke","strokeLinecap","ArrowBottomLeftTopRight","StructogramComponentText","rest","Typography","fontFamily","fontWeight","padding","paddingLeft","StructogramNodeProcess","StructogramNodeLoopFirst","bodyNode","map","subnode","index","StructogramNode","jsxs","StructogramNodeLoopLast","StructogramNodeIfElse","bodyNodeIf","bodyNodeElse","Grid","container","item","xs","display","alignItems","justifyContent","color","zIndex","grey","fitlerEmptyNode","PROCESS","join","trim","LOOP_FIRST","filter","LOOP_LAST","IF_ELSE","Fragment","renderer","id","boxProps","component","fontStyle","filteredNodes","maxWidth","wordBreak","fontVariantLigatures","userSelect","StructogramCodeEditor","value","onValueChange","ReactCodeMirror","onChange","theme","AdaptiveButton","collapse","Tooltip","title","Button","startIcon","endIcon","EditorPage","enqueueSnackbar","useSnackbar","matchBreakpointXs","useMediaQuery","breakpoints","down","popoverExportMenuAnchor","setPopoverExportMenuAnchor","useState","previewOpen","setPreviewOpen","preview","URL","window","location","href","searchParams","get","setNodes","editorContent","setEditorContent","localStorage","setItem","savedContent","getItem","useEffect","lexerGetAllTokens","normalize","onContentChange","useCallback","v","handleSaveSVG","async","HTMLNode","document","getElementById","toSvg","then","blob","saveAs","variant","handleSavePNG","toPng","handleSaveJPEG","toJpeg","handlePreviewToggle","prev","handleCopyLink","url","set","navigator","clipboard","writeText","handlePopoverExportMenuOpen","event","currentTarget","handlePopoverExportMenuClose","Paper","square","elevation","Stack","direction","ButtonGroup","onClick","target","LaunchRounded","DownloadRounded","SendRounded","lg","overflowY","Popover","anchorOrigin","vertical","horizontal","transformOrigin","anchorEl","open","onClose","MenuList","MenuItem","ListItemIcon","fontSize","ListItemText","themeDark","createTheme","palette","mode","App","CssBaseline","ThemeProvider","SnackbarProvider","preventDuplicate","autoHideDuration","ReactDOM","createRoot","render","React","StrictMode"],"mappings":"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"}