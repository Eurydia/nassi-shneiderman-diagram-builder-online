import{j as r,r as a,a as D}from"./react-CoXzz-GY.js";/* empty css                    *//* empty css              */import{c as K}from"./react-dom-DqgNK6QM.js";import{u as ee,S as te}from"./notistack-y89oild8.js";import{a as oe,b as N,s as _,B as H,T as re,P as J,u as q,c as X,G as A,L as ne,D as O,d as se,e as Y,M,f as p,g as C,h as I,i as $,j as ie,k as ce,C as ue,l as le}from"./@mui-Bq87vkUV.js";import{S as de,a as ae,b as he,c as fe,d as ke,e as Pe}from"./@eurydos-CQm71j7Q.js";import"./react-latex-next-ZDIlWtEp.js";import{R as xe}from"./@uiw-C-oNMM4C.js";import{A as me}from"./@codemirror-hB6RxGxE.js";import{F as G}from"./file-saver-BzCbq6H9.js";import{t as ge,a as be,b as Le}from"./html-to-image-iGH67oLV.js";import"./@babel-DL81cLNu.js";import"./scheduler-CzFDRTuY.js";import"./goober-DovPBWGu.js";import"./@emotion-BgjI-VtJ.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./stylis-FDnFs_-n.js";import"./react-is-DcfIKM1A.js";import"./clsx-B-dksMZM.js";import"./react-transition-group-BIXmmEtz.js";import"./@popperjs-BQBsAJpH.js";import"./@lezer-mjs73VwX.js";import"./crelt-C8TCjufn.js";import"./style-mod-Bc2inJdb.js";import"./w3c-keyname-Vcq4gwWv.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function o(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=o(n);fetch(n.href,i)}})();const W=e=>{const{collapsed:t,...o}=e;return t?r.jsx(oe,{title:o.children,children:r.jsxs(N,{...o,startIcon:void 0,endIcon:void 0,children:[o.startIcon,o.endIcon]})}):r.jsx(N,{...o,startIcon:o.startIcon,endIcon:o.endIcon,children:o.children})};var c=(e=>(e[e.EOF=0]="EOF",e[e.SYMBOL=1]="SYMBOL",e[e.KEYWORD=2]="KEYWORD",e[e.WHITE_SPACE=3]="WHITE_SPACE",e[e.LEFT_PAREN=4]="LEFT_PAREN",e[e.RIGHT_PAREN=5]="RIGHT_PAREN",e[e.LEFT_CURLY=6]="LEFT_CURLY",e[e.RIGHT_CURLY=7]="RIGHT_CURLY",e[e.SEMICOLON=8]="SEMICOLON",e))(c||{});const Ee=["for","if","else","while","do"],U={"{":6,"}":7,"(":4,")":5,";":8},Re=e=>{let t="",o=0;for(;o<e.length;){if(o+1<e.length&&e[o]==="/"&&e[o+1]==="/"){for(;o<e.length&&e[o]!==`
`;)o++;continue}t+=e[o],o++}return t},Te=e=>{const t=Re(e.normalize());return{content:t,contentLength:t.length,cursorPos:0,lineNumber:1,charNumber:1}},je=e=>{const t={kind:0,text:"",lineNumber:e.lineNumber,charNumber:e.charNumber};if(e.cursorPos>=e.contentLength)return t;if(t.text=e.content[e.cursorPos],e.cursorPos++,e.charNumber++,/\s/.test(t.text))return t.kind=3,t.text===`
`&&(e.lineNumber++,e.charNumber=1),t;if(t.text in U)return t.kind=U[t.text],t;if(t.text==="$")for(;e.cursorPos<e.contentLength&&(t.text+=e.content[e.cursorPos],e.cursorPos++,e.charNumber++,e.content[e.cursorPos-1]!=="$"););for(;e.cursorPos<e.contentLength&&!(e.content[e.cursorPos]in U)&&!/\s/.test(e.content[e.cursorPos]);)if(t.text+=e.content[e.cursorPos],e.cursorPos++,e.charNumber++,e.content[e.cursorPos-1]==="$")for(;e.cursorPos<e.contentLength&&(t.text+=e.content[e.cursorPos],e.cursorPos++,e.charNumber++,e.content[e.cursorPos-1]!=="$"););return Ee.includes(t.text)?(t.kind=2,t):(t.kind=1,t)},ye=e=>{const t=[];let o;for(;(o=je(e)).kind!==0;)t.push(o);return t};var g=(e=>(e[e.END=0]="END",e[e.ERROR=1]="ERROR",e[e.PROCESS=2]="PROCESS",e[e.LOOP_FIRST=3]="LOOP_FIRST",e[e.LOOP_LAST=4]="LOOP_LAST",e[e.IF_ELSE=5]="IF_ELSE",e[e.FUNCTION=6]="FUNCTION",e))(g||{});const b=e=>({tokens:e,tokenLength:e.length,cursorPos:0}),m=(e,t,o)=>{if(e.cursorPos>=e.tokenLength)return[];if(e.tokens[e.cursorPos].kind!==t)return[];e.cursorPos++;const s=[];let n=-1,i;for(;e.cursorPos<e.tokenLength&&(i=e.tokens[e.cursorPos],e.cursorPos++,s.push(i),i.kind===t&&n--,i.kind===o&&n++,n!==0););return s},h=e=>{if(!(e.cursorPos>=e.tokenLength)&&e.tokens[e.cursorPos].kind===c.WHITE_SPACE){for(;e.tokens[e.cursorPos].kind===c.WHITE_SPACE;)if(e.cursorPos++,e.cursorPos>=e.tokenLength)return}},d=(e,t,o)=>{const{text:s,lineNumber:n,charNumber:i}=e;return{kind:1,reason:`Incomplete ${t} declaration. Missing a "${o}" token.`,context:s,caretOffset:s.length,lineNumber:n,charNumber:i}},P=(e,t,o,s)=>{const{text:n}=e,{text:i,lineNumber:u,charNumber:l}=t;return{kind:1,reason:`Unexpected token found in ${o} declaration. Expected a "${s}" token but found "${i}" instead.`,context:`${n} ${i}`,caretOffset:n.length+1,lineNumber:u,charNumber:l}},pe=e=>{const t={kind:3,body:[],condition:[]};let o=e.tokens[e.cursorPos-1];if(h(e),e.cursorPos>=e.tokenLength)return d(o,"test-first loop","(");if(e.tokens[e.cursorPos].kind!==c.LEFT_PAREN)return P(o,e.tokens[e.cursorPos],"test-first loop","(");if(o=e.tokens[e.cursorPos],t.condition=m(e,c.LEFT_PAREN,c.RIGHT_PAREN),t.condition.length>0&&(o=t.condition[t.condition.length-1]),t.condition.length===0||o.kind!==c.RIGHT_PAREN)return d(o,"test-first loop",")");if(t.condition.pop(),h(e),e.cursorPos>=e.tokenLength)return d(o,"test-first loop","{");if(e.tokens[e.cursorPos].kind!==c.LEFT_CURLY)return P(o,e.tokens[e.cursorPos],"test-first loop","{");o=e.tokens[e.cursorPos];const s=m(e,c.LEFT_CURLY,c.RIGHT_CURLY);return s.length>0&&(o=s[s.length-1]),s.length===0||o.kind!==c.RIGHT_CURLY?d(o,"test-first loop","}"):(s.pop(),t.body=L(b(s)),t)},Ce=e=>{const t={kind:4,body:[],condition:[]};let o=e.tokens[e.cursorPos-1];if(h(e),e.cursorPos>=e.tokenLength)return d(o,"test-last loop","{");if(e.tokens[e.cursorPos].kind!==c.LEFT_CURLY)return P(o,e.tokens[e.cursorPos],"test-last loop","{");o=e.tokens[e.cursorPos];const s=m(e,c.LEFT_CURLY,c.RIGHT_CURLY);return s.length>0&&(o=s[s.length-1]),s.length===0||o.kind!==c.RIGHT_CURLY?d(o,"test-last loop","}"):(s.pop(),h(e),e.cursorPos>=e.tokenLength?d(o,"test-last loop","while"):e.tokens[e.cursorPos].kind!==c.KEYWORD||e.tokens[e.cursorPos].text!=="while"?P(o,e.tokens[e.cursorPos],"test-last loop","while"):(o=e.tokens[e.cursorPos],e.cursorPos++,h(e),e.cursorPos>=e.tokenLength?d(o,"test-last loop","("):e.tokens[e.cursorPos].kind!==c.LEFT_PAREN?P(o,e.tokens[e.cursorPos],"test-last loop","("):(o=e.tokens[e.cursorPos],t.condition=m(e,c.LEFT_PAREN,c.RIGHT_PAREN),t.condition.length>0&&(o=t.condition[t.condition.length-1]),t.condition.length===0||o.kind!==c.RIGHT_PAREN?d(o,"test-last loop",")"):(t.condition.pop(),h(e),e.cursorPos>=e.tokenLength?d(o,"test-last loop",";"):e.tokens[e.cursorPos].kind!==c.SEMICOLON?P(o,e.tokens[e.cursorPos],"test-last loop",";"):(e.cursorPos++,t.body=L(b(s)),t)))))},Ie=e=>{const t={kind:5,condition:[],bodyIf:[],bodyElse:[]};let o=e.tokens[e.cursorPos-1];if(h(e),e.cursorPos>=e.tokenLength)return d(o,"branching block (if)","(");if(e.tokens[e.cursorPos].kind!==c.LEFT_PAREN)return P(o,e.tokens[e.cursorPos],"branching block (if)","(");if(o=e.tokens[e.cursorPos],t.condition=m(e,c.LEFT_PAREN,c.RIGHT_PAREN),t.condition.length>0&&(o=t.condition[t.condition.length-1]),t.condition.length===0||o.kind!==c.RIGHT_PAREN)return d(o,"branching block (if)",")");if(t.condition.pop(),h(e),e.cursorPos>=e.tokenLength)return d(o,"branching block (if)","{");if(e.tokens[e.cursorPos].kind!==c.LEFT_CURLY)return P(o,e.tokens[e.cursorPos],"branching block (if)","{");o=e.tokens[e.cursorPos];const s=m(e,c.LEFT_CURLY,c.RIGHT_CURLY);if(s.length>0&&(o=s[s.length-1]),s.length===0||o.kind!==c.RIGHT_CURLY)return d(o,"branching block (if)","}");if(s.pop(),t.bodyIf=L(b(s)),h(e),e.cursorPos>=e.tokenLength||e.tokens[e.cursorPos].kind!==c.KEYWORD||e.tokens[e.cursorPos].text!=="else")return t;if(o=e.tokens[e.cursorPos],e.cursorPos++,h(e),e.cursorPos>=e.tokenLength)return d(o,"branching block (if-else)","{");if(e.tokens[e.cursorPos].kind!==c.LEFT_CURLY)return P(o,e.tokens[e.cursorPos],"branching block (if-else)","{");o=e.tokens[e.cursorPos];const n=m(e,c.LEFT_CURLY,c.RIGHT_CURLY);return n.length>0&&(o=n[n.length-1]),n.length===0||o.kind!==c.RIGHT_CURLY?d(o,"branching block (if-else)","}"):(n.pop(),t.bodyElse=L(b(n)),t)},Se=e=>{if(h(e),e.cursorPos>=e.tokenLength)return{kind:0};const t=e.tokens[e.cursorPos];if(e.cursorPos++,t.kind===c.KEYWORD)switch(t.text){case"for":case"while":return pe(e);case"do":return Ce(e);case"if":return Ie(e)}const o=[t];let s=t;if(s.kind===c.SEMICOLON)return{kind:2,body:[]};for(;e.cursorPos<e.tokenLength&&e.tokens[e.cursorPos].kind!==c.SEMICOLON&&e.tokens[e.cursorPos].kind!==c.LEFT_CURLY;)s=e.tokens[e.cursorPos],o.push(e.tokens[e.cursorPos]),e.cursorPos++;if(e.cursorPos>=e.tokenLength||e.tokens[e.cursorPos].kind!==c.LEFT_CURLY&&e.tokens[e.cursorPos].kind!==c.SEMICOLON)return d(s,"process",";");if(e.tokens[e.cursorPos].kind===c.SEMICOLON)return e.cursorPos++,{kind:2,body:o};s=e.tokens[e.cursorPos];const n=m(e,c.LEFT_CURLY,c.RIGHT_CURLY);return n.length>0&&(s=n[n.length-1]),n.length===0||s.kind!==c.RIGHT_CURLY?d(s,"function","}"):(n.pop(),{kind:6,declaration:o,body:L(b(n))})},L=e=>{const t=[];let o;for(;(o=Se(e)).kind!==0&&(t.push(o),o.kind!==1););return t},E=e=>{const{bodyTokens:t,...o}=e;let s;return t!==void 0&&(s=t.map(n=>n.text).join("").trim(),s.length===0&&(s=void 0)),r.jsx(ae,{...o,children:s})},ve=e=>{const{conditionTokens:t,body:o,...s}=e;let n;t!==void 0&&t.length>0&&(n=t.map(u=>u.text).join("").trim());let i=r.jsx(E,{borderTop:!0,borderLeft:!0});return o.length>0&&(i=o.map((u,l)=>r.jsx(R,{borderTop:!0,borderLeft:!0,node:u},`subnode-${l}`))),r.jsx(he,{...s,condition:n,children:i})},Oe=e=>{const{conditionTokens:t,body:o,...s}=e;let n;t!==void 0&&t.length>0&&(n=t.map(u=>u.text).join("").trim());let i=r.jsx(E,{borderBottom:!0,borderLeft:!0});return o.length>0&&(i=o.map((u,l)=>r.jsx(R,{node:u,borderBottom:!0,borderLeft:!0},`subnode-${l}`))),r.jsx(fe,{...s,condition:n,children:i})},Ne=e=>{const{conditionTokens:t,bodyIf:o,bodyElse:s,...n}=e;let i;t!==void 0&&t.length>0&&(i=t.map(f=>f.text).join("").trim());let u=r.jsx(E,{borderTop:!0});o.length>0&&(u=o.map((f,x)=>r.jsx(R,{borderTop:!0,node:f},`index-${x}`)));let l=r.jsx(E,{borderTop:!0});return s.length>0&&(l=s.map((f,x)=>r.jsx(R,{borderTop:!0,node:f},`index-${x}`))),r.jsx(ke,{...n,condition:i,childrenIf:u,childrenElse:l})},_e=e=>{const{declarationTokens:t,body:o,...s}=e;let n;t!==void 0&&t.length>0&&(n=t.map(u=>u.text).join("").trim());let i=r.jsx(E,{borderTop:!0,borderLeft:!0,borderRight:!0});return o.length>0&&(i=o.map((u,l)=>r.jsx(R,{node:u,borderTop:!0,borderLeft:!0,borderRight:!0},`subnode-${l}`))),r.jsx(Pe,{...s,declaration:n,children:i})},R=e=>{const{node:t,...o}=e;switch(t.kind){case g.ERROR:return r.jsx(de,{...o,caretOffset:t.caretOffset,context:t.context,reason:t.reason,lineNumber:t.lineNumber,charNumber:t.charNumber});case g.FUNCTION:return r.jsx(_e,{declarationTokens:t.declaration,body:t.body,...o});case g.LOOP_FIRST:return r.jsx(ve,{...o,conditionTokens:t.condition,body:t.body});case g.LOOP_LAST:return r.jsx(Oe,{...o,conditionTokens:t.condition,body:t.body});case g.IF_ELSE:return r.jsx(Ne,{...o,conditionTokens:t.condition,bodyIf:t.bodyIf,bodyElse:t.bodyElse});case g.PROCESS:return r.jsx(E,{...o,bodyTokens:t.body})}return r.jsx(a.Fragment,{})},we=_(H)(({theme:e})=>({maxWidth:"640px",backgroundColor:e.palette.common.white,borderColor:e.palette.text.primary})),Fe=e=>{const{nodes:t,id:o,boxProps:s}=e;let n=r.jsx(re,{fontFamily:"Fira Code",fontStyle:"italic",children:"Nothing to display."});return t.length>0&&(n=t.map((i,u)=>r.jsx(R,{node:i,borderLeft:!0,borderTop:!0,borderRight:!0,borderBottom:u===t.length-1},`top-level-node-${u}`))),r.jsx(H,{sx:s,children:r.jsx(we,{id:o,children:n})})},Ae=e=>{const{value:t,onValueChange:o}=e;return r.jsx(xe,{value:t,onChange:o,theme:"dark",extensions:[me.lineWrapping]})},Ge=(e,t)=>{const[o,s]=a.useState(()=>{const u=new URL(e).searchParams.get("content");if(u!==null)return window.localStorage.setItem(t,u),u;const l=window.localStorage.getItem(t);if(l!==null)try{return JSON.parse(l)}catch{return l}return"Hello World;"});return{editorContent:o,setEditorContent:i=>{s(i),window.localStorage.setItem(t,JSON.stringify(i))}}},Ue=e=>({exportSVG:async()=>{const n=document.getElementById(e);return n===null?!1:ge(n).then(i=>i===null?!1:(G.saveAs(i,"structogram"),!0))},exportJPEG:async()=>{const n=document.getElementById(e);return n===null?!1:Le(n).then(i=>i===null?!1:(G.saveAs(i,"structogram"),!0))},exportPNG:async()=>{const n=document.getElementById(e);return n===null?!1:be(n).then(i=>i===null?!1:(G.saveAs(i,"structogram"),!0))}}),V=(e,t)=>{const o=new URL(t);return o.searchParams.set("preview","true"),o.searchParams.set("content",e),o.href},Be=e=>{const o=new URL(e).searchParams.get("preview");return o!==null&&o==="true"},He=_(J)(({theme:e})=>({padding:e.spacing(1),display:"flex",flexDirection:"row",justifyContent:"space-between"})),B=_(H)({overflow:"auto"}),Ye=r.jsx(N,{href:"https://eurydia.github.io/project-structogram-builder-online-docs/",component:"a",target:"_blank",endIcon:r.jsx(ne,{}),children:"docs"}),Me=e=>{const{slotAppBar:t,slotPanelLeft:o,slotPanelRight:s}=e,n=a.useRef(null);let i=0;n.current!==null&&(i=n.current.getBoundingClientRect().height);const[u,l]=a.useState(Be(window.location.href)),f=()=>{l(j=>!j)},x=q(j=>j.breakpoints.down("md")),T=a.useMemo(()=>`calc(100vh - ${i}px)`,[i]),S=u?"Show code":"Hide code",v=x&&!u?"none":void 0,w=u?"none":void 0;return r.jsxs(B,{children:[r.jsxs(He,{ref:n,square:!0,elevation:4,children:[r.jsxs(X,{disableElevation:!0,variant:"outlined",children:[r.jsx(N,{onClick:f,children:S}),Ye]}),t]}),r.jsxs(A,{container:!0,children:[r.jsx(A,{item:!0,xs:12,lg:6,display:w,children:r.jsx(B,{height:T,children:o})}),r.jsx(A,{item:!0,xs:!0,lg:!0,display:v,children:r.jsx(B,{height:T,children:s})})]})]})},z=_(J)({padding:1}),$e=()=>{const{enqueueSnackbar:e}=ee(),{exportJPEG:t,exportPNG:o,exportSVG:s}=Ue("structogram-preview-region"),{editorContent:n,setEditorContent:i}=Ge(window.location.href,"autosaveContent"),u=q(k=>k.breakpoints.down("md")),[l,f]=a.useState([]),[x,T]=a.useState(null),[S,v]=a.useState(null);a.useEffect(()=>{const k=ye(Te(n)),y=L(b(k));f(y)},[n]);const w=()=>{navigator.clipboard.writeText(V(n,window.location.href)),e("Link copied to clipboard",{variant:"info"})},j=()=>{const y=`<iframe loading="lazy" height="auto" width="100%" src="${V(n,window.location.href)}" style="aspect-ratio: 16/10; border: none;"></iframe>`;navigator.clipboard.writeText(y),e("Link copied to clipboard",{variant:"info"})},Q=k=>{T(k.currentTarget)},Z=k=>{v(k.currentTarget)},F=async k=>{k().then(y=>{if(y){e("Diagram exported",{variant:"info"});return}e("Failed to export diagram",{variant:"error"})})};return r.jsxs(a.Fragment,{children:[r.jsx(Me,{slotAppBar:r.jsxs(X,{disableElevation:!0,variant:"outlined",children:[r.jsx(W,{collapsed:u,startIcon:r.jsx(O,{}),onClick:Q,children:"EXPORT"}),r.jsx(W,{collapsed:u,endIcon:r.jsx(se,{}),onClick:Z,children:"SHARE"})]}),slotPanelLeft:r.jsx(Ae,{value:n,onValueChange:i}),slotPanelRight:r.jsx(Fe,{id:"structogram-preview-region",nodes:l,boxProps:{height:"100%",padding:4,userSelect:"none"}})}),r.jsx(Y,{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},anchorEl:x,open:x!==null,onClose:()=>T(null),children:r.jsx(z,{children:r.jsxs(M,{children:[r.jsxs(p,{onClick:()=>F(t),children:[r.jsx(C,{children:r.jsx(O,{})}),r.jsx(I,{children:"Save as JPEG"})]}),r.jsxs(p,{onClick:()=>F(o),children:[r.jsx(C,{children:r.jsx(O,{})}),r.jsx(I,{children:"Save as PNG"})]}),r.jsxs(p,{onClick:()=>F(s),children:[r.jsx(C,{children:r.jsx(O,{})}),r.jsx(I,{children:"Save as SVG"})]})]})})}),r.jsx(Y,{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},anchorEl:S,open:S!==null,onClose:()=>v(null),children:r.jsx(z,{children:r.jsxs(M,{children:[r.jsxs(p,{onClick:w,children:[r.jsx(C,{children:r.jsx($,{})}),r.jsx(I,{children:"Copy Link"})]}),r.jsxs(p,{onClick:j,children:[r.jsx(C,{children:r.jsx($,{})}),r.jsx(I,{children:"Copy Iframe Embed"})]})]})})})]})},We=ie({palette:{mode:"dark",primary:{main:"#e1cdfe"},text:{primary:ce("#fff",.9)},background:{paper:"#2B2828",default:"#2B2828"}}}),Ve=()=>r.jsxs(a.Fragment,{children:[r.jsx(ue,{}),r.jsx(le,{theme:We,children:r.jsx(te,{preventDuplicate:!0,autoHideDuration:2e3,anchorOrigin:{vertical:"top",horizontal:"center"},children:r.jsx($e,{})})})]});K.createRoot(document.getElementById("root")).render(r.jsx(D.StrictMode,{children:r.jsx(Ve,{})}));
