import{j as r,r as k,a as Q}from"./react-K1CltWfm.js";/* empty css                    *//* empty css              */import{c as Z}from"./react-dom-kxudpsVv.js";import{a as D,b as v,B as b,g as $,T as K,u as W,P as F,c as ee,d as z,L as oe,G as N,D as S,e as te,f as U,M as Y,h as y,i as I,j as p,k as H,l as re,C as ne,m as se}from"./@mui-BcC4-_ja.js";import{S as ie,a as ce,b as ue,c as de,d as le,e as ae}from"./@eurydos-yQ4XrOXy.js";import"./react-latex-next-mrPezsSE.js";import{R as he}from"./@uiw-A-isV_Aa.js";import{A as fe}from"./@codemirror-OnmSk9q8.js";import{u as ke,S as xe}from"./notistack-V61l5x9T.js";import{F as _}from"./file-saver-Dfzu6_5w.js";import{t as Pe,a as ge,b as me}from"./html-to-image-uK6yt3sc.js";import"./@babel-UamSrvRa.js";import"./scheduler-iwWdm5Ml.js";import"./@emotion-USwQ2xCP.js";import"./hoist-non-react-statics-ruMgn741.js";import"./stylis-UTZzoVRx.js";import"./react-is-q81m-9gd.js";import"./clsx-Zbgk8kpT.js";import"./react-transition-group-H4kvz7pl.js";import"./@popperjs-zyV4rJhQ.js";import"./@lezer-ZpeW_cX9.js";import"./crelt-9OWz1RP4.js";import"./style-mod-z-g5kJ9M.js";import"./w3c-keyname-KjuS0gPF.js";import"./goober-S-7Z32hR.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();const B=e=>{const{collapsed:o,...t}=e;return o?r.jsx(D,{title:t.children,children:r.jsxs(v,{...t,startIcon:void 0,endIcon:void 0,children:[t.startIcon,t.endIcon]})}):r.jsx(v,{...t,startIcon:t.startIcon,endIcon:t.endIcon,children:t.children})};var c=(e=>(e[e.EOF=0]="EOF",e[e.SYMBOL=1]="SYMBOL",e[e.KEYWORD=2]="KEYWORD",e[e.WHITE_SPACE=3]="WHITE_SPACE",e[e.LEFT_PAREN=4]="LEFT_PAREN",e[e.RIGHT_PAREN=5]="RIGHT_PAREN",e[e.LEFT_CURLY=6]="LEFT_CURLY",e[e.RIGHT_CURLY=7]="RIGHT_CURLY",e[e.SEMICOLON=8]="SEMICOLON",e))(c||{});const Le=["for","if","else","while","do"],w={"{":6,"}":7,"(":4,")":5,";":8},be=e=>{let o="",t=0;for(;t<e.length;){if(t+1<e.length&&e[t]==="/"&&e[t+1]==="/"){for(;t<e.length&&e[t]!==`
`;)t++;continue}o+=e[t],t++}return o},Ee=e=>{const o=be(e.normalize());return{content:o,contentLength:o.length,cursorPos:0,lineNumber:1,charNumber:1}},Re=e=>{const o={kind:0,text:"",lineNumber:e.lineNumber,charNumber:e.charNumber};if(e.cursorPos>=e.contentLength)return o;if(o.text=e.content[e.cursorPos],e.cursorPos++,e.charNumber++,/\s/.test(o.text))return o.kind=3,o.text===`
`&&(e.lineNumber++,e.charNumber=1),o;if(o.text in w)return o.kind=w[o.text],o;if(o.text==="$")for(;e.cursorPos<e.contentLength&&(o.text+=e.content[e.cursorPos],e.cursorPos++,e.charNumber++,e.content[e.cursorPos-1]!=="$"););for(;e.cursorPos<e.contentLength&&!(e.content[e.cursorPos]in w)&&!/\s/.test(e.content[e.cursorPos]);)if(o.text+=e.content[e.cursorPos],e.cursorPos++,e.charNumber++,e.content[e.cursorPos-1]==="$")for(;e.cursorPos<e.contentLength&&(o.text+=e.content[e.cursorPos],e.cursorPos++,e.charNumber++,e.content[e.cursorPos-1]!=="$"););return Le.includes(o.text)?(o.kind=2,o):(o.kind=1,o)},je=e=>{const o=[];let t;for(;(t=Re(e)).kind!==0;)o.push(t);return o};var m=(e=>(e[e.END=0]="END",e[e.ERROR=1]="ERROR",e[e.PROCESS=2]="PROCESS",e[e.LOOP_FIRST=3]="LOOP_FIRST",e[e.LOOP_LAST=4]="LOOP_LAST",e[e.IF_ELSE=5]="IF_ELSE",e[e.FUNCTION=6]="FUNCTION",e))(m||{});const E=e=>({tokens:e,tokenLength:e.length,cursorPos:0}),g=(e,o,t)=>{if(e.cursorPos>=e.tokenLength)return[];if(e.tokens[e.cursorPos].kind!==o)return[];e.cursorPos++;const s=[];let n=-1,i;for(;e.cursorPos<e.tokenLength&&(i=e.tokens[e.cursorPos],e.cursorPos++,s.push(i),i.kind===o&&n--,i.kind===t&&n++,n!==0););return s},a=e=>{if(!(e.cursorPos>=e.tokenLength)&&e.tokens[e.cursorPos].kind===c.WHITE_SPACE){for(;e.tokens[e.cursorPos].kind===c.WHITE_SPACE;)if(e.cursorPos++,e.cursorPos>=e.tokenLength)return}},l=(e,o,t)=>{const{text:s,lineNumber:n,charNumber:i}=e;return{kind:1,reason:`Incomplete ${o} declaration. Missing a "${t}" token.`,context:s,caretOffset:s.length,lineNumber:n,charNumber:i}},x=(e,o,t,s)=>{const{text:n}=e,{text:i,lineNumber:u,charNumber:d}=o;return{kind:1,reason:`Unexpected token found in ${t} declaration. Expected a "${s}" token but found "${i}" instead.`,context:`${n} ${i}`,caretOffset:n.length+1,lineNumber:u,charNumber:d}},Te=e=>{const o={kind:3,body:[],condition:[]};let t=e.tokens[e.cursorPos-1];if(a(e),e.cursorPos>=e.tokenLength)return l(t,"test-first loop","(");if(e.tokens[e.cursorPos].kind!==c.LEFT_PAREN)return x(t,e.tokens[e.cursorPos],"test-first loop","(");if(t=e.tokens[e.cursorPos],o.condition=g(e,c.LEFT_PAREN,c.RIGHT_PAREN),o.condition.length>0&&(t=o.condition[o.condition.length-1]),o.condition.length===0||t.kind!==c.RIGHT_PAREN)return l(t,"test-first loop",")");if(o.condition.pop(),a(e),e.cursorPos>=e.tokenLength)return l(t,"test-first loop","{");if(e.tokens[e.cursorPos].kind!==c.LEFT_CURLY)return x(t,e.tokens[e.cursorPos],"test-first loop","{");t=e.tokens[e.cursorPos];const s=g(e,c.LEFT_CURLY,c.RIGHT_CURLY);return s.length>0&&(t=s[s.length-1]),s.length===0||t.kind!==c.RIGHT_CURLY?l(t,"test-first loop","}"):(s.pop(),o.body=R(E(s)),o)},Ce=e=>{const o={kind:4,body:[],condition:[]};let t=e.tokens[e.cursorPos-1];if(a(e),e.cursorPos>=e.tokenLength)return l(t,"test-last loop","{");if(e.tokens[e.cursorPos].kind!==c.LEFT_CURLY)return x(t,e.tokens[e.cursorPos],"test-last loop","{");t=e.tokens[e.cursorPos];const s=g(e,c.LEFT_CURLY,c.RIGHT_CURLY);return s.length>0&&(t=s[s.length-1]),s.length===0||t.kind!==c.RIGHT_CURLY?l(t,"test-last loop","}"):(s.pop(),a(e),e.cursorPos>=e.tokenLength?l(t,"test-last loop","while"):e.tokens[e.cursorPos].kind!==c.KEYWORD||e.tokens[e.cursorPos].text!=="while"?x(t,e.tokens[e.cursorPos],"test-last loop","while"):(t=e.tokens[e.cursorPos],e.cursorPos++,a(e),e.cursorPos>=e.tokenLength?l(t,"test-last loop","("):e.tokens[e.cursorPos].kind!==c.LEFT_PAREN?x(t,e.tokens[e.cursorPos],"test-last loop","("):(t=e.tokens[e.cursorPos],o.condition=g(e,c.LEFT_PAREN,c.RIGHT_PAREN),o.condition.length>0&&(t=o.condition[o.condition.length-1]),o.condition.length===0||t.kind!==c.RIGHT_PAREN?l(t,"test-last loop",")"):(o.condition.pop(),a(e),e.cursorPos>=e.tokenLength?l(t,"test-last loop",";"):e.tokens[e.cursorPos].kind!==c.SEMICOLON?x(t,e.tokens[e.cursorPos],"test-last loop",";"):(e.cursorPos++,o.body=R(E(s)),o)))))},ye=e=>{const o={kind:5,condition:[],bodyIf:[],bodyElse:[]};let t=e.tokens[e.cursorPos-1];if(a(e),e.cursorPos>=e.tokenLength)return l(t,"branching block (if)","(");if(e.tokens[e.cursorPos].kind!==c.LEFT_PAREN)return x(t,e.tokens[e.cursorPos],"branching block (if)","(");if(t=e.tokens[e.cursorPos],o.condition=g(e,c.LEFT_PAREN,c.RIGHT_PAREN),o.condition.length>0&&(t=o.condition[o.condition.length-1]),o.condition.length===0||t.kind!==c.RIGHT_PAREN)return l(t,"branching block (if)",")");if(o.condition.pop(),a(e),e.cursorPos>=e.tokenLength)return l(t,"branching block (if)","{");if(e.tokens[e.cursorPos].kind!==c.LEFT_CURLY)return x(t,e.tokens[e.cursorPos],"branching block (if)","{");t=e.tokens[e.cursorPos];const s=g(e,c.LEFT_CURLY,c.RIGHT_CURLY);if(s.length>0&&(t=s[s.length-1]),s.length===0||t.kind!==c.RIGHT_CURLY)return l(t,"branching block (if)","}");if(s.pop(),o.bodyIf=R(E(s)),a(e),e.cursorPos>=e.tokenLength||e.tokens[e.cursorPos].kind!==c.KEYWORD||e.tokens[e.cursorPos].text!=="else")return o;if(t=e.tokens[e.cursorPos],e.cursorPos++,a(e),e.cursorPos>=e.tokenLength)return l(t,"branching block (if-else)","{");if(e.tokens[e.cursorPos].kind!==c.LEFT_CURLY)return x(t,e.tokens[e.cursorPos],"branching block (if-else)","{");t=e.tokens[e.cursorPos];const n=g(e,c.LEFT_CURLY,c.RIGHT_CURLY);return n.length>0&&(t=n[n.length-1]),n.length===0||t.kind!==c.RIGHT_CURLY?l(t,"branching block (if-else)","}"):(n.pop(),o.bodyElse=R(E(n)),o)},Ie=e=>{if(a(e),e.cursorPos>=e.tokenLength)return{kind:0};const o=e.tokens[e.cursorPos];if(e.cursorPos++,o.kind===c.KEYWORD)switch(o.text){case"for":case"while":return Te(e);case"do":return Ce(e);case"if":return ye(e)}const t=[o];let s=o;if(s.kind===c.SEMICOLON)return{kind:2,body:[]};for(;e.cursorPos<e.tokenLength&&e.tokens[e.cursorPos].kind!==c.SEMICOLON&&e.tokens[e.cursorPos].kind!==c.LEFT_CURLY;)s=e.tokens[e.cursorPos],t.push(e.tokens[e.cursorPos]),e.cursorPos++;if(e.cursorPos>=e.tokenLength||e.tokens[e.cursorPos].kind!==c.LEFT_CURLY&&e.tokens[e.cursorPos].kind!==c.SEMICOLON)return l(s,"process",";");if(e.tokens[e.cursorPos].kind===c.SEMICOLON)return e.cursorPos++,{kind:2,body:t};s=e.tokens[e.cursorPos];const n=g(e,c.LEFT_CURLY,c.RIGHT_CURLY);return n.length>0&&(s=n[n.length-1]),n.length===0||s.kind!==c.RIGHT_CURLY?l(s,"function","}"):(n.pop(),{kind:6,declaration:t,body:R(E(n))})},R=e=>{const o=[];let t;for(;(t=Ie(e)).kind!==0&&(o.push(t),t.kind!==1););return o},j=e=>{const{bodyTokens:o,...t}=e;let s;return o!==void 0&&(s=o.map(n=>n.text).join("").trim(),s.length===0&&(s=void 0)),r.jsx(ce,{...t,children:s})},pe=e=>{const{conditionTokens:o,body:t,...s}=e;let n;o!==void 0&&o.length>0&&(n=o.map(u=>u.text).join("").trim());let i=r.jsx(j,{borderTop:!0,borderLeft:!0});return t.length>0&&(i=t.map((u,d)=>r.jsx(T,{borderTop:!0,borderLeft:!0,node:u},`subnode-${d}`))),r.jsx(ue,{...s,condition:n,children:i})},Se=e=>{const{conditionTokens:o,body:t,...s}=e;let n;o!==void 0&&o.length>0&&(n=o.map(u=>u.text).join("").trim());let i=r.jsx(j,{borderBottom:!0,borderLeft:!0});return t.length>0&&(i=t.map((u,d)=>r.jsx(T,{node:u,borderBottom:!0,borderLeft:!0},`subnode-${d}`))),r.jsx(de,{...s,condition:n,children:i})},ve=e=>{const{conditionTokens:o,bodyIf:t,bodyElse:s,...n}=e;let i;o!==void 0&&o.length>0&&(i=o.map(h=>h.text).join("").trim());let u=r.jsx(j,{borderTop:!0});t.length>0&&(u=t.map((h,P)=>r.jsx(T,{borderTop:!0,node:h},`index-${P}`)));let d=r.jsx(j,{borderTop:!0});return s.length>0&&(d=s.map((h,P)=>r.jsx(T,{borderTop:!0,node:h},`index-${P}`))),r.jsx(le,{...n,condition:i,childrenIf:u,childrenElse:d})},Oe=e=>{const{declarationTokens:o,body:t,...s}=e;let n;o!==void 0&&o.length>0&&(n=o.map(u=>u.text).join("").trim());let i=r.jsx(j,{borderTop:!0,borderLeft:!0,borderRight:!0});return t.length>0&&(i=t.map((u,d)=>r.jsx(T,{node:u,borderTop:!0,borderLeft:!0,borderRight:!0},`subnode-${d}`))),r.jsx(ae,{...s,declaration:n,children:i})},T=e=>{const{node:o,...t}=e;switch(o.kind){case m.ERROR:return r.jsx(ie,{...t,caretOffset:o.caretOffset,context:o.context,reason:o.reason,lineNumber:o.lineNumber,charNumber:o.charNumber});case m.FUNCTION:return r.jsx(Oe,{declarationTokens:o.declaration,body:o.body,...t});case m.LOOP_FIRST:return r.jsx(pe,{...t,conditionTokens:o.condition,body:o.body});case m.LOOP_LAST:return r.jsx(Se,{...t,conditionTokens:o.condition,body:o.body});case m.IF_ELSE:return r.jsx(ve,{...t,conditionTokens:o.condition,bodyIf:o.bodyIf,bodyElse:o.bodyElse});case m.PROCESS:return r.jsx(j,{...t,bodyTokens:o.body})}return r.jsx(k.Fragment,{})},Ne=e=>{const{nodes:o,id:t,boxProps:s}=e;let n=r.jsx(K,{fontFamily:"Fira Code",fontStyle:"italic",children:"Nothing to display."});return o.length>0&&(n=o.map((i,u)=>r.jsx(T,{node:i,borderLeft:!0,borderTop:!0,borderRight:!0,borderBottom:u===o.length-1},`top-level-node-${u}`))),r.jsx(b,{sx:s,children:r.jsx(b,{id:t,sx:{maxWidth:"640px",backgroundColor:"#fff",borderColor:$[700]},children:n})})},_e=e=>{const{value:o,onValueChange:t}=e;return r.jsx(he,{value:o,onChange:t,theme:"dark",extensions:[fe.lineWrapping]})},M=(e,o)=>{const t=new URL(o);return t.searchParams.set("preview","true"),t.searchParams.set("content",e),t.href},we=e=>{const t=new URL(e).searchParams.get("preview");return t!==null&&t==="true"},Fe=e=>{const{slotAppBar:o,slotPanelLeft:t,slotPanelRight:s}=e,n=k.useRef(null);let i=0;n.current!==null&&(i=n.current.getBoundingClientRect().height);const[u,d]=k.useState(we(window.location.href)),h=()=>{d(L=>!L)},P=W(L=>L.breakpoints.down("md"));return r.jsxs(b,{sx:{backgroundColor:"#fff",borderColor:$[700]},children:[r.jsx(F,{ref:n,square:!0,elevation:0,sx:{padding:1},children:r.jsxs(ee,{display:"flex",direction:"row",justifyContent:"space-between",children:[r.jsxs(z,{variant:"outlined",children:[r.jsx(v,{onClick:h,children:u?"Show code":"Hide code"})," ",r.jsx(v,{href:"https://eurydia.github.io/project-structogram-builder-online-docs/",component:"a",target:"_blank",endIcon:r.jsx(oe,{}),children:"docs"})]}),o]})}),r.jsx(b,{children:r.jsxs(N,{container:!0,children:[r.jsx(N,{item:!0,xs:12,lg:6,display:u?"none":void 0,children:r.jsx(b,{overflow:"auto",height:`calc(100vh - ${i}px)`,children:t})}),r.jsx(N,{item:!0,xs:!0,lg:!0,display:P&&!u?"none":void 0,children:r.jsx(b,{overflow:"auto",height:`calc(100vh - ${i}px)`,children:s})})]})})]})},Ae=(e,o)=>{const[t,s]=k.useState(()=>{const u=new URL(e).searchParams.get("content");if(u!==null)return window.localStorage.setItem(o,u),u;const d=window.localStorage.getItem(o);if(d!==null)try{return JSON.parse(d)}catch{return d}return"Hello World;"});return{editorContent:t,setEditorContent:i=>{s(i),window.localStorage.setItem(o,JSON.stringify(i))}}},Ge=e=>({exportSVG:async()=>{const n=document.getElementById(e);return n===null?!1:Pe(n).then(i=>i===null?!1:(_.saveAs(i,"structogram"),!0))},exportJPEG:async()=>{const n=document.getElementById(e);return n===null?!1:me(n).then(i=>i===null?!1:(_.saveAs(i,"structogram"),!0))},exportPNG:async()=>{const n=document.getElementById(e);return n===null?!1:ge(n).then(i=>i===null?!1:(_.saveAs(i,"structogram"),!0))}}),Ue=()=>{const{enqueueSnackbar:e}=ke(),{exportJPEG:o,exportPNG:t,exportSVG:s}=Ge("structogram-preview-region"),{editorContent:n,setEditorContent:i}=Ae(window.location.href,"autosaveContent"),u=W(f=>f.breakpoints.down("md")),[d,h]=k.useState([]),[P,L]=k.useState(null),[A,G]=k.useState(null);k.useEffect(()=>{const f=je(Ee(n)),C=R(E(f));h(C)},[n]);const J=()=>{navigator.clipboard.writeText(M(n,window.location.href)),e("Link copied to clipboard",{variant:"info"})},V=()=>{const C=`<iframe loading="lazy" height="auto" width="100%" src="${M(n,window.location.href)}" style="aspect-ratio: 16/10; border: none;"></iframe>`;navigator.clipboard.writeText(C),e("Link copied to clipboard",{variant:"info"})},q=f=>{L(f.currentTarget)},X=f=>{G(f.currentTarget)},O=async f=>{f().then(C=>{if(C){e("Diagram exported",{variant:"info"});return}e("Failed to export diagram",{variant:"error"})})};return r.jsxs(k.Fragment,{children:[r.jsx(Fe,{slotAppBar:r.jsxs(z,{variant:"outlined",children:[r.jsx(B,{collapsed:u,startIcon:r.jsx(S,{}),onClick:q,children:"EXPORT"}),r.jsx(B,{collapsed:u,endIcon:r.jsx(te,{}),onClick:X,children:"SHARE"})]}),slotPanelLeft:r.jsx(_e,{value:n,onValueChange:i}),slotPanelRight:r.jsx(Ne,{nodes:d,id:"structogram-preview-region",boxProps:{height:"100%",padding:4,userSelect:"none"}})}),r.jsx(U,{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},anchorEl:P,open:P!==null,onClose:()=>L(null),children:r.jsx(F,{sx:{padding:1},children:r.jsxs(Y,{children:[r.jsxs(y,{onClick:()=>O(o),children:[r.jsx(I,{children:r.jsx(S,{})}),r.jsx(p,{children:"Save as JPEG"})]}),r.jsxs(y,{onClick:()=>O(t),children:[r.jsx(I,{children:r.jsx(S,{})}),r.jsx(p,{children:"Save as PNG"})]}),r.jsxs(y,{onClick:()=>O(s),children:[r.jsx(I,{children:r.jsx(S,{})}),r.jsx(p,{children:"Save as SVG"})]})]})})}),r.jsx(U,{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},anchorEl:A,open:A!==null,onClose:()=>G(null),children:r.jsx(F,{sx:{padding:1},children:r.jsxs(Y,{children:[r.jsxs(y,{onClick:J,children:[r.jsx(I,{children:r.jsx(H,{})}),r.jsx(p,{children:"Copy Link"})]}),r.jsxs(y,{onClick:V,children:[r.jsx(I,{children:r.jsx(H,{})}),r.jsx(p,{children:"Copy Iframe Embed"})]})]})})})]})},Ye=re({palette:{mode:"dark"}}),He=()=>r.jsxs(k.Fragment,{children:[r.jsx(ne,{}),r.jsx(se,{theme:Ye,children:r.jsx(xe,{preventDuplicate:!0,autoHideDuration:2e3,anchorOrigin:{vertical:"top",horizontal:"center"},children:r.jsx(Ue,{})})})]});Z.createRoot(document.getElementById("root")).render(r.jsx(Q.StrictMode,{children:r.jsx(He,{})}));
